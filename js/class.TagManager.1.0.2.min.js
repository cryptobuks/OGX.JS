if(typeof OGX==="undefined"){var OGX=function(){}}OGX.prototype.TagManager=function(a){"use strict";var n=this;var e=a;var t={editable:false,tags:[],currentTags:[],tagsAscii:[],mode:OGX.TagManager.MODE_STRING,keycode:13,placeholder:"keywords",enabled:true};this.type="RcpTagManager";this.el=null;this.enable=function(){if(!e.enabled){e.enabled=true;_(true);u(true);l(true);$(e.container).find(".ogx_tag_manager_input:first").prop("placeholder",e.placeholder);$(e.container).find(".ogx_tag_manager_input:first").prop("disabled",false)}};this.disable=function(){if(e.enabled){e.enabled=false;_(false);u(false);l(false);$(e.container).find(".ogx_tag_manager_input:first").prop("placeholder","");$(e.container).find(".ogx_tag_manager_input:first").prop("disabled",true)}};this.setTags=function(a){e.tags=a;return true};this.getTags=function(){return e.tags};this.getCurrentTags=function(){return e.currentTags};this.setCurrentTags=function(a){e.currentTags=a;return s(e.currentTags)};this.showTags=function(a){return s(a)};this.addTag=function(a){return r(a)};this.removeTag=function(a){return i(a)};this.destroy=function(){_(false);u(false);l(false)};function r(a){if(e.currentTags.indexOf(a)===-1){e.currentTags.push(a);var n="";e.editable===true?n='<img src="/images/ogx/tag_remove.png">':null;var t='<span class="ogx_tag_manager_tag"><span>'+a+"</span>"+n+"</span>";$(e.container).find(".ogx_tag_manager_tags:first").append(t);$(e.container).trigger(OGX.TagManager.TAG_ADDED,a);$(e.container).find(".ogx_tag_manager_input:first").focus()}}function i(a){var n=e.currentTags.indexOf(a);if(n>-1){e.currentTags.splice(n,1);$(e.container).find(".ogx_tag_manager_tags:first").find(".ogx_tag_manager_tag").each(function(n,e){if($(e).find("span:first").text()===a){$(e).remove();return true}})}return false}function g(a,n){if(a){if($(e.container).find(".ogx_tag_manager_tags_container:first").length>0){g(false);u(false)}var t='<div class="ogx_tag_manager_tags_container">';for(var r=0;r<n.length;r++){t+='<span class="ogx_tag_manager_tag ogx_tag_manager_tags_container_tag">'+n[r]+"</span>"}t+="</div>";$(e.container).append(t);u(true)}else{$(e.container).find(".ogx_tag_manager_tags_container").remove();u(false)}}function s(a){var n="";var t="";for(var r=0;r<a.length;r++){e.editable===true?t='<img src="/images/ogx/tag_remove.png">':t="";n+='<span class="ogx_tag_manager_tag"><span>'+a[r]+"</span>"+t+"</span>"}e.currentTags=a;$(e.container).find(".ogx_tag_manager_tags:first").html(n);return true}function o(a){var n=[];a=a.substr(0,3);for(var t=0;t<e.tags.length;t++){if(e.tags[t].toLowerCase().indexOf(a.toLowerCase())===0){n.push(e.tags[t])}}return n}function f(a){var n=a.substr(0,3);var t=c(n);var r=[];if(e.tagsAscii[t]){for(var i=0;i<e.tagsAscii[t].length;i++){if(e.tagsAscii[t][i].toLowerCase().indexOf(a.toLowerCase())!==-1){r.push(e.tagsAscii[t][i])}}}return r}function c(a){var n="";for(var e=0;e<a.length;e++){n+=a.toLowerCase().charCodeAt(e).toString()}return n}function _(a){if(a){$(e.container).find(".ogx_tag_manager_input:first").on("keyup",function(a){var n=$(this).val();if(n.length>=3){if(a.which===e.keycode){r(n);$(e.container).find(".ogx_tag_manager_input:first").val("");g(false)}else{var t;switch(e.mode){case OGX.TagManager.MODE_STRING:t=o(n);break;case OGX.TagManager.MODE_ASCII:t=f(n);break}if(t.length>0){g(true,t)}else{g(false)}}}else{g(false)}})}else{$(e.container).find(".ogx_tag_manager_input:first").off("keyup")}}function u(a){if(a){$(e.container).find(".ogx_tag_manager_tags_container:first").on("click",".ogx_tag_manager_tags_container_tag",function(){var a=$(this).text();r(a);$(e.container).find(".ogx_tag_manager_input:first").val("");g(false)})}else{$(e.container).find(".ogx_tag_manager_tags_container:first").off("click",".ogx_tag_manager_tags_container_tag")}}function l(a){if(a){$(e.container).on("click",".ogx_tag_manager_tags img",function(){var a=$(this).parent("span:first").find("span:first").text();i(a);$(e.container).trigger(OGX.TagManager.TAG_REMOVED,a);$(e.container).find(".ogx_tag_manager_input:first").focus()})}else{$(e.container).off("click",".ogx_tag_manager_tags")}}function d(){$(e.container).addClass("ogx_tag_manager");$(e.container).html('<span class="ogx_tag_manager_tags"></span><input type="text" class="ogx_tag_manager_input" placeholder="'+e.placeholder+'">')}function p(){if(!e){e={}}for(var a in t){if(!e.hasOwnProperty(a)){e[a]=t[a]}}n.el=$(e.container)}function m(){p();d();if(!e.enabled||!e.editable){e.enabled=true;n.disable()}else{e.enabled=false;n.enable()}}m()};OGX.TagManager=function(a){"use strict";return new OGX.prototype.TagManager(a)};OGX.TagManager.TAG_ADDED="tagAdded";OGX.TagManager.TAG_REMOVED="tagRemoved";OGX.TagManager.MODE_STRING="modeString";OGX.TagManager.MODE_ASCII="modeAscii";