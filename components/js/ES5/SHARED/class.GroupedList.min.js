if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.GroupedList=function(r){"use strict";function t(r){for(var t in r){var e=o(t,r[t]);return e}return!1}function o(r,t){var o=g.list;return o.sort(e(r,t)),o}function e(r,t){var o=new RegExp("^[0-9]{4}-[0-9]{2}-[0-9]{2}$");return function(e,n){return o.test(e[r])?moment(e[r]).unix()<moment(n[r]).unix()?t*-1:moment(e[r]).unix()>moment(n[r]).unix()?t:0:e[r]<n[r]?t*-1:e[r]>n[r]?t:0}}function n(){for(var r,t={},o=0;o<g.list.length;o++)r=a(g.list[o]),r&&(t.hasOwnProperty(r)||(t[r]=[]),t[r].push({item:g.list[o],pos:o}));return t}function a(r){if(r.hasOwnProperty(g.group_by)){var t=r[g.group_by];if(!g.group_option)return t;switch(g.group_option){case"substr":return t=t.substr(g.group_param[0],g.group_param[1]);case"numrange":return t=Number(t),Array.isArray(g.group_param)?(t=Math.floor(t/g.group_param[0]),t="pre"===g.group_param[2]?g.group_param[1]+t*g.group_param[0]+" - "+g.group_param[1]+(t+1)*g.group_param[0]:t*g.group_param[0]+g.group_param[1]+" - "+(t+1)*g.group_param[0]+g.group_param[1]):(t=Math.floor(t/g.group_param),t=t*g.group_param+" - "+(t+1)*g.group_param),t;case"daterange":if(!Array.isArray(g.group_param)){if("year"===g.group_param)return t=t.substr(0,4);if("month"===g.group_param)return t=t.substr(0,7);if("week"===g.group_param)return t=t.substr(0,4)+" week "+moment(t).week()}return t=moment(t).unix(),t=Math.floor(t/(60*g.group_param[0]*60*24)),t*=60*g.group_param[0]*60*24,t=moment(1e3*t).format(g.group_param[1])+" - "+moment(1e3*t+1e3*g.group_param[0]*60*60*24).format(g.group_param[1])}}return!1}function u(r){var t,o,e=[];for(var n in r){o=g.group_option?n:r[n][0].item[g.group_by],t={title:o,body:"",scopes:["public"],open:!0};for(var a=0;a<r[n].length;a++)t.body+=OGX.Templater.templatize(r[n][a].item,g.template);e.push(t)}return e}function p(){for(var r in c)g.hasOwnProperty(r)||(g[r]=c[r]);f.el=s=$(g.container),s.addClass("ogx_grouped_list")}function i(){if("undefined"==typeof moment)return void console.log("%c CRITICAL ERROR - moment.js not found! ","background:#222; color: #FF0000");if("undefined"==typeof OGX.Templater)return void console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000");if("undefined"==typeof OGX.Templater)return void console.log("%c CRITICAL ERROR - OGX.NestedList not found! ","background:#222; color: #FF0000");p(),g.sort&&(l=t(g.sort)),l=n();var r=u(l);m=new OGX.NestedList({container:g.container,enabled:g.enabled,data:r})}var s,m,l,f=this,g=r,c={group_by:"name",group_option:null,group_param:null,sort:null,template:"",enabled:!0,list:[]};this.el=null,this.enable=function(){g.enabled||(g.enabled=!0,m.enable())},this.disable=function(){g.enabled&&(g.enabled=!1,m.disable())},this.setList=function(){g.list=l,m.setData(u(l))},this.getList=function(){return g.list},this.sortList=function(r,t){var e=o(r,t);m.setData(u(e))},this.destroy=function(){m.destroy()},i()},OGX.GroupedList=function(r){"use strict";return new OGX.prototype.GroupedList(r)},OGX.GroupedList.SELECT="select";