if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.GroupedList=function(t){"use strict";function r(t){for(var r in t){var n=e(r,t[r]);return n}return!1}function e(t,r){var e=d.list;return e.sort(n(t,r)),e}function n(t,r){return function(e,n){return e[t]<n[t]?r*-1:e[t]>n[t]?r:0}}function o(){for(var t,r={},e=0;e<d.list.length;e++)t=a(d.list[e]),t&&(r.hasOwnProperty(t)||(r[t]=[]),r[t].push({item:d.list[e],pos:e}));return r}function a(t){if(t.hasOwnProperty(d.group_by)){var r=t[d.group_by];if(!d.group_option)return r;switch(d.group_option){case"substr":return r=r.substr(d.group_param[0],d.group_param[1]);case"numrange":return r=Number(r),r=Math.floor(r/d.group_param),r=r*d.group_param+" - "+(r+1)*d.group_param;case"daterange":var e=moment(r).unix(),n=moment(d.group_param[0]).unix(),o=moment(d.group_param[1]).unix();if(e>=n&&r<=o)return moment(d.group_param[0]).format("YYYY-MM-DD")+" - "+moment(d.group_param[1]).format("YYYY-MM-DD")}}return!1}function u(t){var r,e,n=[];for(var o in t){if(d.group_option)switch(d.group_option){case"substr":case"numrange":e=o;break;case"daterange":e=o+" ("+d.group_param[0]+" to "+d.group_param[1]+")"}else e=t[o][0].item[d.group_by];r={title:e,body:"",scopes:["public"],open:!0};for(var a=0;a<t[o].length;a++)r.body+=OGX.Templater.templatize(t[o][a].item,d.template);n.push(r)}return n}function i(){for(var t in m)d.hasOwnProperty(t)||(d[t]=m[t]);f.el=p=$(d.container),p.addClass("ogx_grouped_list")}function s(){if("undefined"==typeof moment)return void console.log("%c CRITICAL ERROR - moment.js not found! ","background:#222; color: #FF0000");if("undefined"==typeof OGX.Templater)return void console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000");if("undefined"==typeof OGX.Templater)return void console.log("%c CRITICAL ERROR - OGX.NestedList not found! ","background:#222; color: #FF0000");i(),d.sort&&(c=r(d.sort)),c=o();var t=u(c);l=new OGX.NestedList({container:d.container,enabled:d.enabled,data:t})}var p,l,c,f=this,d=t,m={group_by:"name",group_option:null,group_param:null,sort:null,template:"",enabled:!0,list:[]};this.el=null,this.enable=function(){d.enabled||(d.enabled=!0,l.enable())},this.disable=function(){d.enabled&&(d.enabled=!1,l.disable())},this.setList=function(){d.list=c,l.setData(u(c))},this.getList=function(){return d.list},this.sortList=function(t,r){var n=e(t,r);l.setData(u(n))},this.destroy=function(){l.destroy()},s()},OGX.GroupedList=function(t){"use strict";return new OGX.prototype.GroupedList(t)},OGX.GroupedList.SELECT="select";