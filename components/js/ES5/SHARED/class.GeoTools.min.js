if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.GeoTools=function(o){function t(o){var t=new google.maps.LatLng(o.coords.latitude,o.coords.longitude),e={gmap:t,raw:{lat:o.coords.latitude,lng:o.coords.longitude}};l?(l(e),l=null):$(document).trigger(OGX.GeoTools.BROWSER_LOC_SUCCESS,e)}function e(o){$(document).trigger(OGX.GeoTools.BROWSER_LOC_ERROR,o)}function a(){if(g.map){var o=g.map.getBounds(),t=o.getCenter(),e=o.getNorthEast(),a=3963,n=t.lat()/57.2958,r=t.lng()/57.2958,s=e.lat()/57.2958,i=e.lng()/57.2958,d=a*Math.acos(Math.sin(n)*Math.sin(s)+Math.cos(n)*Math.cos(s)*Math.cos(i-r));return d}return!1}function n(){var o=g.map.getCenter(),t=new google.maps.LatLng(o.lat(),o.lng());return t}function r(){for(var o in u)g.hasOwnProperty(o)||(g[o]=u[o])}function s(){return"undefined"==typeof google||"undefined"==typeof google.maps?void $(document).trigger(OGX.GeoTools.ERROR_GMAP):(i=new google.maps.Geocoder,g||(g={}),r(),void(g.map&&g.markers.length>0))}var i,d,c,l,u={map:null,markers:[],icon:"",browser_loc:null},g=o;this.setMap=function(o){g.map=o},this.getMap=function(){return g.map},this.getMapRadius=function(){return!!g.map&&a()},this.getCurrentLocation=function(){return!!g.map&&n()},this.getBrowserLocation=function(o){l="undefined"==typeof o?null:o,c=navigator.geolocation.getCurrentPosition(t,e,{maximumAge:0,timeout:1e4,enableHighAccuracy:!0})},this.addressToLatLng=function(o,t,e){i.geocode({address:o},function(o,a){a==google.maps.GeocoderStatus.OK?t(o[0].geometry.location,e):t(!1,e)})},this.getCityBoundaries=function(o,t,e,a,n){i.geocode({address:o+", "+t+", "+e},function(o,t){t==google.maps.GeocoderStatus.OK?a(o[0].geometry,n):a(!1,n)})},this.latLngToZip=function(o,t,e){i.geocode({location:o},function(o,a){if(a===google.maps.GeocoderStatus.OK){var n=o[0].formatted_address.match(/([a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|([0-9]{2}[ ]?[0-9]{3})/);n?t(n[0],e):t(null,e)}else t(!1,e)})},this.latLngToCountryStateCity=function(o,t,e){i.geocode({location:o},function(o,a){if(a===google.maps.GeocoderStatus.OK){for(var n={},r=0;r<o[0].address_components.length;r++)o[0].address_components[r].types.indexOf("locality")!==-1&&(n.city=o[0].address_components[r].short_name),o[0].address_components[r].types.indexOf("administrative_area_level_1")!==-1&&(n.state=o[0].address_components[r].short_name),o[0].address_components[r].types.indexOf("country")!==-1&&(n.country=o[0].address_components[r].short_name);t(n,e)}else t(!1,e)})},this.latLngToAddress=function(o,t,e){i.geocode({location:o},function(a,n){if(n===google.maps.GeocoderStatus.OK){var r={},s=a[0].formatted_address.match(/([a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|([0-9]{2}[ ]?[0-9]{3})/);s&&(r.zip=s[0]);var s=a[0].formatted_address.match(/[ ]([a-zA-Z]+)$/);s&&(r.country=s[1]);var s=a[0].formatted_address.match(/[ ]([A-Z]{2})[ ](?:[a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|(?:[0-9]{2}[ ]?[0-9]{3})/);s&&(r.state=s[1]);var s=a[0].formatted_address.match(/(?:[, ]+)?(['a-zA-Z]+[\- ]?[a-zA-Z]+)[,](?:[ ][A-Z]{2}[ ])/);s&&(r.city=s[1]);var s=a[0].formatted_address.match(/^([0-9]+)[ ]([a-zA-Z' ]+)[, ]/);s&&(r.number=s[1],r.street=s[2]),r.formatted=a[0].formatted_address,r.lat=o.lat,r.lng=o.lng,t(r,e)}else t(!1,e)})},this.zipToAddress=function(o,t,e){i.geocode({address:o},function(o,a){if(a===google.maps.GeocoderStatus.OK){var n={},r=o[0].formatted_address.match(/([a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|([0-9]{2}[ ]?[0-9]{3})/);r&&(n.zip=r[0]);var r=o[0].formatted_address.match(/[ ]([a-zA-Z]+)$/);r&&(n.country=r[1]);var r=o[0].formatted_address.match(/[ ]([A-Z]{2})[ ](?:[a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|(?:[0-9]{2}[ ]?[0-9]{3})/);r&&(n.state=r[1]);var r=o[0].formatted_address.match(/(?:[, ]+)?(['a-zA-Z]+[\- ]?[a-zA-Z]+)[,](?:[ ][A-Z]{2}[ ])/);r&&(n.city=r[1]);var r=o[0].formatted_address.match(/^([0-9]+)[ ]([a-zA-Z' ]+)[, ]/);r&&(n.number=r[1],n.street=r[2]),n.formatted=o[0].formatted_address,n.lat=o[0].geometry.location.lat(),n.lng=o[0].geometry.location.lng(),t(n,e)}else t(!1,e)})},this.zipToLatLng=function(o,t,e){i.geocode({address:o},function(o,a){if(a===google.maps.GeocoderStatus.OK){var n={};n.lat=o[0].geometry.location.lat(),n.lng=o[0].geometry.location.lng(),t(n,e)}else t(!1,e)})},this.getRoute=function(o,t,e,a,n){if("undefined"==typeof e)var e=OGX.GeoTools.TRAVEL_MODE_CAR;var r=new google.maps.DirectionsService,s={origin:o,destination:t,travelMode:e};r.route(s,function(o,t){t===google.maps.DirectionsStatus.OK?a(o,n):a(!1,n)})},this.calcRouteMinutes=function(o){for(var t=0,e=0;e<o.legs.length;e++)t+=o.legs[e].duration.value;return t=Math.round(t/60)},this.drawRoute=function(o){d||(d=new google.maps.DirectionsRenderer),d.setMap(g.map),d.setDirections(o)},this.clearMap=function(){g.map&&d&&d.setMap(null)},s()},OGX.GeoTools=function(o){"use strict";return new OGX.prototype.GeoTools(o)},OGX.GeoTools.ERROR="error",OGX.GeoTools.ERROR_GMAP="errorGmap",OGX.GeoTools.TRAVEL_MODE_CAR="DRIVING",OGX.GeoTools.TRAVEL_MODE_TRANSIT="TRANSIT",OGX.GeoTools.TRAVEL_MODE_WALK="WALKING",OGX.GeoTools.TRAVEL_MODE_BIKE="BICYCLING",OGX.GeoTools.BROWSER_LOC_SUCCESS="BROWSER_LOC_SUCCESS",OGX.GeoTools.BROWSER_LOC_ERROR="BROWSER_LOC_ERROR";