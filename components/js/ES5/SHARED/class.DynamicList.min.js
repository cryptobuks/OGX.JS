if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.DynamicList=function(e){"use strict";function t(){u.filter.list=s(),u.start=0,u.bind.pager&&(u.bind.pager.setPages(Math.ceil(u.filter.list.length*u.limit)),u.bind.pager.setPageBlock(0),u.bind.pager.setPage(0)),n(u.filter.list)}function i(){for(var e in h)for(var t in h[e].options)p.unbind(e,t)}function s(){var e,t,i,s,n,l,a,r,o,c,d={},f=[],m=!1;y=!0;for(var g=0;g<u.list.length;g++){r=0,a=0;for(L in h){h[L].matches=0,c=!1,o=0;for(var p in h[L].options)if(h[L].options[p].include&&(c||(c=!0,a++),u.list[g].hasOwnProperty(L)&&(e=String(u.list[g][L]).toLowerCase(),h[L].options[p].vals.length>0))){m=!0;for(var _=0;_<h[L].options[p].vals.length;_++)switch(o++,p){case"min":t=Number(u.list[g][L]),isNaN(t)||t>=Number(h[L].options[p].vals[_])&&h[L].matches++;break;case"max":t=Number(u.list[g][L]),isNaN(t)||t<=Number(h[L].options[p].vals[_])&&h[L].matches++;break;case"in":e.indexOf(h[L].options[p].vals[_].toLowerCase())!==-1&&h[L].matches++;break;case"out":e.indexOf(h[L].options[p].vals[_].toLowerCase())==-1&&h[L].matches++;break;case"from":i=new Date(e),n=i.getTime(),s=new Date(h[L].options[p].vals[_]),l=s.getTime(),n>=l&&h[L].matches++;break;case"to":i=new Date(e),n=i.getTime(),s=new Date(h[L].options[p].vals[_]),l=s.getTime(),n<=l&&h[L].matches++;break;case"include":e.indexOf(h[L].options[p].vals[_].toLowerCase())!==-1&&h[L].matches++;break;case"exclude":e.indexOf(h[L].options[p].vals[_].toLowerCase())==-1&&h[L].matches++;break;default:if(h[L].options[p].hasOwnProperty("mode"))switch(h[L].options[p].mode){case"strict":e.toLowerCase()===h[L].options[p].vals[_].toLowerCase()&&h[L].matches++;break;case"include":e.indexOf(h[L].options[p].vals[_].toLowerCase())!==-1&&h[L].matches++}else e.toLowerCase()===h[L].options[p].vals[_].toLowerCase()&&h[L].matches++}}o===h[L].matches&&o&&r++}r===a&&(d[g]=!0)}if(m)for(var L in d)f.push(u.list[L]);else y=!1,f=u.list;return f}function n(e){if(p.clearList(),"undefined"!=typeof e&&0!==e.length){var t=0,i=e.length;u.limit&&(i=u.limit),u.start&&(t=u.start),i=t+i,i>e.length?i=e.length:null,u.limit&&(u.pages=Math.ceil(e.length/u.limit)),u.bind.pager&&u.bind.pager.setPages(u.pages);for(var s,n,a,r=t;r<i;r++)s='<li class="ogx_dynamic_list_item',n=o(e[r]),e[r].hasOwnProperty("css")&&(s+=" "+e[r].css),u.css&&(s+=" "+u.css),s+=n?' ogx_dynamic_list_selected_item"':'"',u.key&&(s+=" data-"+u.key+'="'+e[r][u.key]+'"'),s+=">",s+=l(e[r]),s+="</li>",u.components?a=$(u.list_container).append(s).get(0):$(u.list_container).append(s);u.trigger&&$(u.container).trigger(OGX.DynamicList.RENDER,p)}}function l(e){return OGX.DynamicList.templateObject(e,u.template)}function a(){$(u.list_container).on("click",".ogx_dynamic_list_item",function(e){if(u.enabled){var t=$(e.currentTarget).index();if(u.bind.pager&&u.limit&&(t+=u.bind.pager.getPage()*u.limit),"multi"===u.mode)return $(this).hasClass("ogx_dynamic_list_selected_item")?($(this).removeClass("ogx_dynamic_list_selected_item"),void(u.filter.enabled&&y?(r(u.filter.list[t]),$(u.container).trigger(OGX.DynamicList.UNSELECT,u.filter.list[t])):(r(u.list[t]),$(u.container).trigger(OGX.DynamicList.UNSELECT,u.list[t])))):($(this).addClass("ogx_dynamic_list_selected_item"),void(u.filter.enabled&&y?(u.selected.push(u.filter.list[t]),$(u.container).trigger(OGX.DynamicList.SELECT,u.filter.list[t])):(u.selected.push(u.list[t]),$(u.container).trigger(OGX.DynamicList.SELECT,u.list[t]))));if("toggle"===u.mode)return $(this).hasClass("ogx_dynamic_list_selected_item")?($(this).removeClass("ogx_dynamic_list_selected_item"),u.selected=[],void(u.filter.enabled&&y?$(u.container).trigger(OGX.DynamicList.UNSELECT,u.filter.list[t]):$(u.container).trigger(OGX.DynamicList.UNSELECT,u.list[t]))):($(u.list_container).find(".ogx_dynamic_list_item").removeClass("ogx_dynamic_list_selected_item"),$(this).addClass("ogx_dynamic_list_selected_item"),void(u.filter.enabled&&y?(u.selected=[u.filter.list[t]],$(u.container).trigger(OGX.DynamicList.SELECT,u.filter.list[t])):(u.selected=[u.list[t]],$(u.container).trigger(OGX.DynamicList.SELECT,u.list[t]))));if($(u.list_container).find(".ogx_dynamic_list_selected_item")[0]==$(this)[0])return;return $(u.list_container).find(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item"),$(this).addClass("ogx_dynamic_list_selected_item"),void(u.filter.enabled&&y?(u.selected=[u.filter.list[t]],$(u.container).trigger(OGX.DynamicList.SELECT,u.filter.list[t])):(u.selected=[u.list[t]],$(u.container).trigger(OGX.DynamicList.SELECT,u.list[t])))}})}function r(e){for(var t=!1,i=0;i<u.selected.length;i++)if(t=u.key?e[u.key]===u.selected[i][u.key]:c(e,u.selected[i]))return u.selected.splice(i,1),!0;return!1}function o(e){for(var t=!1,i=0;i<u.selected.length;i++)if(t=u.key?e[u.key]===u.selected[i][u.key]:c(e,u.selected[i]))return!0;return!1}function c(e,t){if(u.key)return e[u.key]===t[u.key];for(var i in e)if(t[i]!==e[i])return!1;return!0}function d(e,t){var i=u.list;return i.sort(f(e,t)),i}function f(e,t){return function(i,s){return i[e]<s[e]?t*-1:i[e]>s[e]?t:0}}function m(){u||(u={});for(var e in _)u.hasOwnProperty(e)||(u[e]=_[e]);p.el=$(u.container)}function g(){m(),$(u.container).append('<ul class="ogx_dynamic_list"></ul>'),u.list_container=$(u.container).find(".ogx_dynamic_list:first"),u.list&&n(u.list),a()}var p=this,u=e,_={container:null,list_container:null,enabled:!0,selectable:!0,key:null,mode:"single",filter:{enabled:!1,list:[]},bind:{pager:null},trigger:!1,limit:10,pages:0,components:!1,list:[],selected:[],css:null},h={},y=!1;this.el=null,this.type="OgxDynamicList",this.enable=function(){u.enabled=!0},this.disable=function(){u.enabled=!1},this.setPage=function(e){u.start=u.limit*e,p.renderList()},this.setLimit=function(e){u.limit=e,p.renderList()},this.getItemPage=function(e,t){var i;if(!u.limit)return 0;var s=u.list;u.filter.enabled&&y&&(s=u.filter.list);for(var n=0;n<s.length;n++)if(s[n][e]===t)return i=Math.floor(n/u.limit)},this.setCSS=function(e){u.css&&$(u.container).find(".ogx_dynamic_list_item").removeClass(u.css),u.css=e,$(u.container).find(".ogx_dynamic_list_item").addClass(e)},this.setTemplate=function(e){u.template=e},this.getList=function(){return u.list?u.list:[]},this.setList=function(e){u.start=0,u.list=e,u.selected=[],u.filter.enabled&&y?(u.filter.list=s(),n(u.filter.list)):n(u.list),u.bind.pager&&(0===u.list.length&&u.bind.pager.setPages(1),u.bind.pager.setPage(0))},this.clearList=function(){$(u.list_container).empty()},this.setMode=function(e){u.mode!==e&&(u.mode=e,p.resetSelection())},this.bind=function(e,i,s,n){"undefined"!=typeof s&&null!==s||(s=i);var l,a;if(l=typeof e,"object"===l){if(e.hasOwnProperty("type")&&e.type)switch(e.type){case"OgxTagManager":u.filter.enabled=!0,h.hasOwnProperty(i)||(h[i]={options:{}}),l=e.getCurrentTags(),a=!1,l.length>0&&(a=!0),h[i].options[s]={obj:e,type:e.type,vals:l,include:a},$(e.el).on(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED,function(n,l){var a=e.getCurrentTags();h[i].options[s].vals=a,h[i].options[s].include=a.length>0,t()});break;case"OgxDynamicPager":u.bind.pager=e,$(e.el).on(OGX.DynamicPager.SELECT_PAGE,function(e,t){u.start=t.page*u.limit,p.renderList()}),u.bind.pager.setPages(Math.ceil(u.list.length/u.limit));break;case"OgxDynamicList":u.filter.enabled=!0,h.hasOwnProperty(i)||(h[i]={options:{}}),h[i].options[s]={obj:e,mode:n,type:e.type,vals:[],include:!1},$(e.el).on(OGX.DynamicList.SELECT+" "+OGX.DynamicList.UNSELECT,function(n,l){for(var a=e.getSelectedItems(),r=[],o=0;o<a.length;o++)r.push(a[o][s]);h[i].options[s].vals=r,h[i].options[s].include=r.length>0,t()})}}else if("string"===l&&$(e).length>0){u.filter.enabled=!0,h.hasOwnProperty(i)||(h[i]={options:{}});var r=$(e).val().trim().toLowerCase();switch(a=!1,r.length>0&&(a=!0),h[i].options[s]={obj:$(e),type:"input",vals:[r],include:a,mode:n},$(e).attr("type").toLowerCase()){case"text":case"range":h[i].options[s].obj.on("input",function(){var e=$(this).val().trim().toLowerCase(),n=e.split(" ");h[i].options[s].vals=n;var l=h[i].options[s].include;h[i].options[s].include=n.length>0,(n.length>0!==l||n.length>0)&&t()})}}},this.unbind=function(e,t){switch("undefined"==typeof t&&(t=e),h[e].options[t].type){case"OgxTagManager":h[e].options[t].obj.el.off(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED);break;case"OgxDynamicPager":h[e].options[t].obj.el.off(OGX.DynamicPager.SELECT_PAGE);break;case"OgxDynamicList":h[e].options[t].obj.el.off(OGX.DynamicList.SELECT+" "+OGX.DynamicList.UNSELECT);break;case"input":h[e].options[t].obj.off("input focusout")}delete h[e].options[t]},this.getSelectedItem=function(){return u.selected[0]},this.getSelectedItems=function(){return u.selected},this.getItem=function(e,t){for(var i=0;i<u.list.length;i++)if(u.list[i][e]&&u.list[i][e]===t)return u.list[i]},this.selectItems=function(e,t,i,s){var n,l=[];"undefined"==typeof i&&(i=!1),"undefined"==typeof s&&(s=!1);for(var a=0;a<u.list.length;a++)u.list[a][e]&&u.list[a][e]===t&&(u.selected.push(u.list[a]),l.push(u.list[a]),n=a,u.bind.pager&&u.limit?n=a+u.bind.pager.getPage()*u.limit:$(u.container).find(".ogx_dynamic_list_item:eq("+a+")").addClass("ogx_dynamic_list_selected_item"));return i||p.renderList(),s&&$(u.container).trigger(OGX.DynamicList.SELECT,u.selected),l},this.selectList=function(e,t,i){for(var s=0;s<u.list.length;s++)u.list[s].hasOwnProperty(e)&&t.indexOf(u.list[s][e])!==-1&&u.selected.push(u.list[s]);i||p.renderList()},this.updateSelectedItem=function(e){u.selected[0]=e,p.renderSelectedItem()},this.updateSelectedItems=function(e){if(u.key){for(var t=0;t<e.length;t++)for(var i=0;i<u.selected.length;i++)if(u.selected[i][u.key]===e[t][u.key]){u.selected[i]=e[t];break}}else for(var t=0;t<e.length;t++)u.selected[t]=e[t];p.renderSelectedItems()},this.renderSelectedItem=function(){var e=$(u.list_container).find(".ogx_dynamic_list_selected_item"),t=l(u.selected[0]);$(e).html(t),u.trigger&&$(u.container).trigger(OGX.DynamicList.RENDER_ITEM,u.selected[0])},this.renderSelectedItems=function(){var e;if(u.key)for(var t,i=0;i<u.selected.length;i++)t=u.selected[i][u.key],e=l(u.selected[i]),$(u.list_container).find(".ogx_dynamic_list_selected_item[data-"+u.key+'="'+t+'"]').html(e);else $(u.list_container).find(".ogx_dynamic_list_selected_item").each(function(t,i){e=l(u.selected[i]),$(t).html(e)})},this.resetSelection=function(){$(u.list_container).find(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item"),u.selected=[]},this.addItem=function(e,t){u.list.push(e),u.filter.enabled&&(u.filter.list=s()),t&&("multi"===u.mode?u.selected.push(e):u.selected=[e]),p.renderList()},this.addItemAt=function(e,t){if(u.list.length>0){var i=u.list.splice(0,t-1);i.push(e);var n=u.list.splice(t);u.list=i.concat(n)}else u.list.push(e);u.filter.enabled&&(u.filter.list=s()),p.renderList()},this.removeItem=function(e,t){for(var i=0;i<u.list.length;i++)if(u.list[i][e]&&u.list[i][e]===t)return u.list.splice(i,1),u.filter.enabled&&(u.filter.list=s()),p.renderList(),!0;return!1},this.removeSelectedItems=function(){for(var e,t=!1;u.selected.length>0;)for(var i=0;i<u.list.length&&(t=!1,u.key?u.list[i][u.key]===u.selected[0][u.key]&&(t=!0):(e=c(u.list[i],u.selected[0]),e&&(t=!0)),!t||(u.list.splice(i,1),u.selected.splice(0,1),i--,0!==u.selected.length));i++);u.filter.enabled&&(u.filter.list=s()),p.renderList()},this.updateItem=function(e,t,i){for(var n=0;n<u.list.length;n++)if(u.list[n][e]===t){u.list[n]=i;break}u.filter.enabled&&(u.filter.list=s()),p.renderList()},this.renderBlock=function(e,t){t&&(u.limit=t),u.start=e*u.limit,p.renderList()},this.renderList=function(){if(u.filter.enabled){var e=s();n(e)}else n(u.list)},this.sortList=function(e,t){u.list&&(d(e,t),u.filter.enabled&&(u.filter.list=s()),p.renderList())},this.destroy=function(){i(),$(u.list_container).off("click",".ogx_dynamic_list_item")},g()},OGX.DynamicList=function(e){"use strict";return new OGX.prototype.DynamicList(e)},OGX.DynamicList.templateObject=function(__obj,__template){function evalOp(__op){var reg=new RegExp("\\@","g");return __op=__op.replace(reg,"__obj."),eval(__op),!0}function extractOps(){var e=new RegExp("\\$\\([^(]*\\)","g"),t=__template.match(e);if(t)for(var i,s=0;s<t.length;s++)i=t[s].substr(1),__template=__template.replace(t[s],""),evalOp(i)}function scan(e,t){var i;for(var s in e)if(i=t.length>0?t+"."+s:s,"object"==typeof e[s])scan(e[s],i);else{var n=new RegExp("(\\$"+i+")","g");__template=__template.replace(n,e[s])}}return extractOps(),scan(__obj,""),__template},OGX.DynamicList.SELECT="DynamicListSelect",OGX.DynamicList.UNSELECT="DynamicListUnselect",OGX.DynamicList.FILTER="DynamicListFilter",OGX.DynamicList.RENDER="DynamicListRender",OGX.DynamicList.RENDER_ITEM="DynamicListRenderItem";