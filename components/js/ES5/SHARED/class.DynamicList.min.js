if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.DynamicList=function(e){"use strict";function t(){p.filter.list=s(),p.start=0,p.bind.pager&&(p.bind.pager.setPages(Math.ceil(p.filter.list.length*p.limit)),p.bind.pager.setPageBlock(0),p.bind.pager.setPage(0)),n(p.filter.list)}function i(){for(var e in _)for(var t in _[e].options)u.unbind(e,t)}function s(){var e,t,i,s,n,l,r,a,o,c,d={},f=[],g=!1;y=!0;for(var m=0;m<p.list.length;m++){a=0,r=0;for(L in _){_[L].matches=0,c=!1,o=0;for(var u in _[L].options)if(_[L].options[u].include&&(c||(c=!0,r++),p.list[m].hasOwnProperty(L)&&(e=String(p.list[m][L]).toLowerCase(),_[L].options[u].vals.length>0))){g=!0;for(var h=0;h<_[L].options[u].vals.length;h++)switch(o++,u){case"min":t=Number(p.list[m][L]),isNaN(t)||t>=Number(_[L].options[u].vals[h])&&_[L].matches++;break;case"max":t=Number(p.list[m][L]),isNaN(t)||t<=Number(_[L].options[u].vals[h])&&_[L].matches++;break;case"in":e.indexOf(_[L].options[u].vals[h].toLowerCase())!==-1&&_[L].matches++;break;case"out":e.indexOf(_[L].options[u].vals[h].toLowerCase())==-1&&_[L].matches++;break;case"from":i=new Date(e),n=i.getTime(),s=new Date(_[L].options[u].vals[h]),l=s.getTime(),n>=l&&_[L].matches++;break;case"to":i=new Date(e),n=i.getTime(),s=new Date(_[L].options[u].vals[h]),l=s.getTime(),n<=l&&_[L].matches++;break;default:if(_[L].options[u].hasOwnProperty("mode"))switch(_[L].options[u].mode){case"strict":e.toLowerCase()===_[L].options[u].vals[h].toLowerCase()&&_[L].matches++;break;case"include":e.indexOf(_[L].options[u].vals[h].toLowerCase())!==-1&&_[L].matches++}else e.toLowerCase()===_[L].options[u].vals[h].toLowerCase()&&_[L].matches++}}o===_[L].matches&&o&&a++}a===r&&(d[m]=!0)}if(g)for(var L in d)f.push(p.list[L]);else y=!1,f=p.list;return f}function n(e){if(u.clearList(),"undefined"!=typeof e&&0!==e.length){var t=0,i=e.length;p.limit&&(i=p.limit),p.start&&(t=p.start),i=t+i,i>e.length?i=e.length:null,p.limit&&(p.pages=Math.ceil(e.length/p.limit)),p.bind.pager&&p.bind.pager.setPages(p.pages);for(var s,n,r,a=t;a<i;a++)s='<li class="ogx_dynamic_list_item',n=o(e[a]),e[a].hasOwnProperty("css")&&(s+=" "+e[a].css),p.css&&(s+=" "+p.css),s+=n?' ogx_dynamic_list_selected_item"':'"',p.key&&(s+=" data-"+p.key+'="'+e[a][p.key]+'"'),s+=">",s+=l(e[a]),s+="</li>",p.components?r=$(p.list_container).append(s).get(0):$(p.list_container).append(s);p.trigger&&$(p.container).trigger(OGX.DynamicList.RENDER,u)}}function l(e){function t(e,s){var n;for(var l in e)if(n=s.length>0?s+"."+l:l,"object"==typeof e[l])t(e[l],n);else{var r=new RegExp("\\$"+n,"g");i=i.replace(r,e[l])}}var i=p.template;return t(e,""),i}function r(){$(p.list_container).on("click",".ogx_dynamic_list_item",function(e){if(p.enabled){var t=$(e.currentTarget).index();if(p.bind.pager&&p.limit&&(t+=p.bind.pager.getPage()*p.limit),"multi"===p.mode)return $(this).hasClass("ogx_dynamic_list_selected_item")?($(this).removeClass("ogx_dynamic_list_selected_item"),void(p.filter.enabled&&y?(a(p.filter.list[t]),$(p.container).trigger(OGX.DynamicList.UNSELECT,p.filter.list[t])):(a(p.list[t]),$(p.container).trigger(OGX.DynamicList.UNSELECT,p.list[t])))):($(this).addClass("ogx_dynamic_list_selected_item"),void(p.filter.enabled&&y?(p.selected.push(p.filter.list[t]),$(p.container).trigger(OGX.DynamicList.SELECT,p.filter.list[t])):(p.selected.push(p.list[t]),$(p.container).trigger(OGX.DynamicList.SELECT,p.list[t]))));if("toggle"===p.mode)return $(this).hasClass("ogx_dynamic_list_selected_item")?($(this).removeClass("ogx_dynamic_list_selected_item"),p.selected=[],void(p.filter.enabled&&y?$(p.container).trigger(OGX.DynamicList.UNSELECT,p.filter.list[t]):$(p.container).trigger(OGX.DynamicList.UNSELECT,p.list[t]))):($(p.list_container).find(".ogx_dynamic_list_item").removeClass("ogx_dynamic_list_selected_item"),$(this).addClass("ogx_dynamic_list_selected_item"),void(p.filter.enabled&&y?(p.selected=[p.filter.list[t]],$(p.container).trigger(OGX.DynamicList.SELECT,p.filter.list[t])):(p.selected=[p.list[t]],$(p.container).trigger(OGX.DynamicList.SELECT,p.list[t]))));if($(p.list_container).find(".ogx_dynamic_list_selected_item")[0]==$(this)[0])return;return $(p.list_container).find(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item"),$(this).addClass("ogx_dynamic_list_selected_item"),void(p.filter.enabled&&y?(p.selected=[p.filter.list[t]],$(p.container).trigger(OGX.DynamicList.SELECT,p.filter.list[t])):(p.selected=[p.list[t]],$(p.container).trigger(OGX.DynamicList.SELECT,p.list[t])))}})}function a(e){for(var t=!1,i=0;i<p.selected.length;i++)if(t=p.key?e[p.key]===p.selected[i][p.key]:c(e,p.selected[i]))return p.selected.splice(i,1),!0;return!1}function o(e){for(var t=!1,i=0;i<p.selected.length;i++)if(t=p.key?e[p.key]===p.selected[i][p.key]:c(e,p.selected[i]))return!0;return!1}function c(e,t){if(p.key)return e[p.key]===t[p.key];for(var i in e)if(t[i]!==e[i])return!1;return!0}function d(e,t){var i=p.list;return i.sort(f(e,t)),i}function f(e,t){return function(i,s){return i[e]<s[e]?t*-1:i[e]>s[e]?t:0}}function g(){p||(p={});for(var e in h)p.hasOwnProperty(e)||(p[e]=h[e]);u.el=$(p.container)}function m(){g(),$(p.container).append('<ul class="ogx_dynamic_list"></ul>'),p.list_container=$(p.container).find(".ogx_dynamic_list:first"),p.list&&n(p.list),r()}var u=this,p=e,h={container:null,list_container:null,enabled:!0,selectable:!0,key:null,mode:"single",filter:{enabled:!1,list:[]},bind:{pager:null},trigger:!1,limit:10,pages:0,components:!1,list:[],selected:[],css:null},_={},y=!1;this.el=null,this.type="OgxDynamicList",this.enable=function(){p.enabled=!0},this.disable=function(){p.enabled=!1},this.setPage=function(e){p.start=p.limit*e,u.renderList()},this.setLimit=function(e){p.limit=e,u.renderList()},this.getItemPage=function(e,t){var i;if(!p.limit)return 0;var s=p.list;p.filter.enabled&&y&&(s=p.filter.list);for(var n=0;n<s.length;n++)if(s[n][e]===t)return i=Math.floor(n/p.limit)},this.setCSS=function(e){p.css&&$(p.container).find(".ogx_dynamic_list_item").removeClass(p.css),p.css=e,$(p.container).find(".ogx_dynamic_list_item").addClass(e)},this.setTemplate=function(e){p.template=e},this.getList=function(){return p.list?p.list:[]},this.setList=function(e){p.start=0,p.list=e,p.selected=[],p.filter.enabled&&y?(p.filter.list=s(),n(p.filter.list)):n(p.list),p.bind.pager&&(0===p.list.length&&p.bind.pager.setPages(1),p.bind.pager.setPage(0))},this.clearList=function(){$(p.list_container).empty()},this.bind=function(e,i,s,n){if("undefined"==typeof s||null===s)var s=i;var l;if(l=typeof e,"object"===l){if(e.hasOwnProperty("type")&&e.type)switch(e.type){case"OgxTagManager":p.filter.enabled=!0,_.hasOwnProperty(i)||(_[i]={options:{}});var l=e.getCurrentTags(),r=!1;l.length>0&&(r=!0),_[i].options[s]={obj:e,type:e.type,vals:l,include:r},$(e.el).on(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED,function(n,l){var r=e.getCurrentTags();_[i].options[s].vals=r,_[i].options[s].include=r.length>0,t()});break;case"OgxDynamicPager":p.bind.pager=e,$(e.el).on(OGX.DynamicPager.SELECT_PAGE,function(e,t){p.start=t.page*p.limit,u.renderList()}),p.bind.pager.setPages(Math.ceil(p.list.length/p.limit));break;case"OgxDynamicList":p.filter.enabled=!0,_.hasOwnProperty(i)||(_[i]={options:{}}),_[i].options[s]={obj:e,mode:n,type:e.type,vals:[],include:!1},$(e.el).on(OGX.DynamicList.SELECT+" "+OGX.DynamicList.UNSELECT,function(n,l){for(var r=e.getSelectedItems(),a=[],o=0;o<r.length;o++)a.push(r[o][s]);_[i].options[s].vals=a,_[i].options[s].include=a.length>0,t()})}}else if("string"===l&&$(e).length>0){p.filter.enabled=!0,_.hasOwnProperty(i)||(_[i]={options:{}});var a=$(e).val().trim().toLowerCase(),r=!1;switch(a.length>0&&(r=!0),_[i].options[s]={obj:$(e),type:"input",vals:[a],include:r,mode:n},$(e).attr("type").toLowerCase()){case"text":case"range":_[i].options[s].obj.on("input",function(){var e=$(this).val().trim().toLowerCase(),n=e.split(" ");_[i].options[s].vals=n;var l=_[i].options[s].include;_[i].options[s].include=n.length>0,(n.length>0!==l||n.length>0)&&t()})}}},this.unbind=function(e,t){if("undefined"==typeof t)var t=e;switch(_[e].options[t].type){case"OgxTagManager":_[e].options[t].obj.el.off(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED);break;case"OgxDynamicPager":_[e].options[t].obj.el.off(OGX.DynamicPager.SELECT_PAGE);break;case"OgxDynamicList":_[e].options[t].obj.el.off(OGX.DynamicList.SELECT+" "+OGX.DynamicList.UNSELECT);break;case"input":_[e].options[t].obj.off("input focusout")}delete _[e].options[t]},this.getSelectedItem=function(){return p.selected[0]},this.getSelectedItems=function(){return p.selected},this.getItem=function(e,t){for(var i=0;i<p.list.length;i++)if(p.list[i][e]&&p.list[i][e]===t)return p.list[i]},this.selectItems=function(e,t,i){for(var s,n=[],l=0;l<p.list.length;l++)p.list[l][e]&&p.list[l][e]===t&&(p.selected.push(p.list[l]),n.push(p.list[l]),s=l,p.bind.pager&&p.limit?s=l+p.bind.pager.getPage()*p.limit:$(p.container).find(".ogx_dynamic_list_item:eq("+l+")").addClass("ogx_dynamic_list_selected_item"));return i||u.renderList(),n},this.selectList=function(e,t,i){for(var s=0;s<p.list.length;s++)p.list[s].hasOwnProperty(e)&&t.indexOf(p.list[s][e])!==-1&&p.selected.push(p.list[s]);i||u.renderList()},this.updateSelectedItem=function(e){p.selected[0]=e,u.renderSelectedItem()},this.renderSelectedItem=function(){var e=$(p.list_container).find(".ogx_dynamic_list_selected_item"),t=l(p.selected[0]);$(e).html(t)},this.resetSelection=function(){$(p.list_container).find(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item"),p.selected=[]},this.addItem=function(e,t){p.list.push(e),p.filter.enabled&&(p.filter.list=s()),t&&("multi"==p.mode?p.selected.push(e):p.selected=[e]),u.renderList()},this.addItemAt=function(e,t){if(p.list.length>0){var i=p.list.splice(0,t-1);i.push(e);var n=p.list.splice(t);p.list=i.concat(n)}else p.list.push(e);p.filter.enabled&&(p.filter.list=s()),u.renderList()},this.removeItem=function(e,t){for(var i=0;i<p.list.length;i++)if(p.list[i][e]&&p.list[i][e]===t)return p.list.splice(i,1),p.filter.enabled&&(p.filter.list=s()),u.renderList(),!0;return!1},this.removeSelectedItems=function(){for(var e;p.selected.length>0;)for(var t=0;t<p.list.length&&(e=c(p.list[t],p.selected[0]),!e||(p.list.splice(t,1),p.selected.splice(0,1),t--,0!==p.selected.length));t++);p.filter.enabled&&(p.filter.list=s()),u.renderList()},this.updateItem=function(e,t,i){for(var n=0;n<p.list.length;n++)if(p.list[n][e]===t){p.list[n]=i;break}p.filter.enabled&&(p.filter.list=s()),u.renderList()},this.renderBlock=function(e,t){t&&(p.limit=t),p.start=e*p.limit,u.renderList()},this.renderList=function(){if(p.filter.enabled){var e=s();n(e)}else n(p.list)},this.sortList=function(e,t){p.list&&(d(e,t),p.filter.enabled&&(p.filter.list=s()),u.renderList())},this.destroy=function(){i(),$(p.list_container).off("click",".ogx_dynamic_list_item")},m()},OGX.DynamicList=function(e){"use strict";return new OGX.prototype.DynamicList(e)},OGX.DynamicList.SELECT="DynamicListSelect",OGX.DynamicList.UNSELECT="DynamicListUnselect",OGX.DynamicList.FILTER="DynamicListFilter",OGX.DynamicList.RENDER="DynamicListRender";