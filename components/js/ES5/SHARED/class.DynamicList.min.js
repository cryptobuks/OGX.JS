if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.DynamicList=function(e){"use strict";function t(){h.filter.list=s(),h.start=0,h.bind.pager&&(h.bind.pager.setPages(Math.ceil(h.filter.list.length*h.limit)),h.bind.pager.setPageBlock(0),h.bind.pager.setPage(0)),n(h.filter.list)}function i(){for(var e in _)for(var t in _[e].options)u.unbind(e,t)}function s(){var e,t,i,s,n,l,r,a,o,c,d={},f=[],m=!1;y=!0;for(var g=0;g<h.list.length;g++){a=0,r=0;for(v in _){_[v].matches=0,c=!1,o=0;for(var u in _[v].options)if(_[v].options[u].include&&(c||(c=!0,r++),h.list[g].hasOwnProperty(v)&&(e=String(h.list[g][v]).toLowerCase(),_[v].options[u].vals.length>0))){m=!0;for(var p=0;p<_[v].options[u].vals.length;p++)switch(o++,u){case"min":t=Number(h.list[g][v]),isNaN(t)||t>=Number(_[v].options[u].vals[p])&&_[v].matches++;break;case"max":t=Number(h.list[g][v]),isNaN(t)||t<=Number(_[v].options[u].vals[p])&&_[v].matches++;break;case"in":e.indexOf(_[v].options[u].vals[p].toLowerCase())!==-1&&_[v].matches++;break;case"out":e.indexOf(_[v].options[u].vals[p].toLowerCase())==-1&&_[v].matches++;break;case"from":i=new Date(e),n=i.getTime(),s=new Date(_[v].options[u].vals[p]),l=s.getTime(),n>=l&&_[v].matches++;break;case"to":i=new Date(e),n=i.getTime(),s=new Date(_[v].options[u].vals[p]),l=s.getTime(),n<=l&&_[v].matches++;break;case"include":e.indexOf(_[v].options[u].vals[p].toLowerCase())!==-1&&_[v].matches++;break;case"exclude":e.indexOf(_[v].options[u].vals[p].toLowerCase())==-1&&_[v].matches++;break;default:if(_[v].options[u].hasOwnProperty("mode"))switch(_[v].options[u].mode){case"strict":e.toLowerCase()===_[v].options[u].vals[p].toLowerCase()&&_[v].matches++;break;case"include":e.indexOf(_[v].options[u].vals[p].toLowerCase())!==-1&&_[v].matches++}else e.toLowerCase()===_[v].options[u].vals[p].toLowerCase()&&_[v].matches++}}o===_[v].matches&&o&&a++}a===r&&(d[g]=!0)}if(m)for(var v in d)f.push(h.list[v]);else y=!1,f=h.list;return f}function n(e){if(u.clearList(),"undefined"!=typeof e&&0!==e.length){var t=0,i=e.length;h.limit&&(i=h.limit),h.start&&(t=h.start),i=t+i,i>e.length?i=e.length:null,h.limit&&(h.pages=Math.ceil(e.length/h.limit)),h.bind.pager&&h.bind.pager.setPages(h.pages);for(var s,n,r,a=t;a<i;a++)s='<li class="ogx_dynamic_list_item',n=o(e[a]),e[a].hasOwnProperty("css")&&(s+=" "+e[a].css),h.css&&(s+=" "+h.css),s+=n?' ogx_dynamic_list_selected_item"':'"',h.key&&(s+=" data-"+h.key+'="'+e[a][h.key]+'"'),s+=">",s+=l(e[a]),s+="</li>",h.components?r=$(h.list_container).append(s).get(0):$(h.list_container).append(s);h.trigger&&$(h.container).trigger(OGX.DynamicList.RENDER,u)}}function l(e){function t(e,s){var n;for(var l in e)if(n=s.length>0?s+"."+l:l,"object"==typeof e[l])t(e[l],n);else{var r=new RegExp("\\$"+n,"g");i=i.replace(r,e[l])}}var i=h.template;return t(e,""),i}function r(){$(h.list_container).on("click",".ogx_dynamic_list_item",function(e){if(h.enabled){var t=$(e.currentTarget).index();if(h.bind.pager&&h.limit&&(t+=h.bind.pager.getPage()*h.limit),"multi"===h.mode)return $(this).hasClass("ogx_dynamic_list_selected_item")?($(this).removeClass("ogx_dynamic_list_selected_item"),void(h.filter.enabled&&y?(a(h.filter.list[t]),$(h.container).trigger(OGX.DynamicList.UNSELECT,h.filter.list[t])):(a(h.list[t]),$(h.container).trigger(OGX.DynamicList.UNSELECT,h.list[t])))):($(this).addClass("ogx_dynamic_list_selected_item"),void(h.filter.enabled&&y?(h.selected.push(h.filter.list[t]),$(h.container).trigger(OGX.DynamicList.SELECT,h.filter.list[t])):(h.selected.push(h.list[t]),$(h.container).trigger(OGX.DynamicList.SELECT,h.list[t]))));if("toggle"===h.mode)return $(this).hasClass("ogx_dynamic_list_selected_item")?($(this).removeClass("ogx_dynamic_list_selected_item"),h.selected=[],void(h.filter.enabled&&y?$(h.container).trigger(OGX.DynamicList.UNSELECT,h.filter.list[t]):$(h.container).trigger(OGX.DynamicList.UNSELECT,h.list[t]))):($(h.list_container).find(".ogx_dynamic_list_item").removeClass("ogx_dynamic_list_selected_item"),$(this).addClass("ogx_dynamic_list_selected_item"),void(h.filter.enabled&&y?(h.selected=[h.filter.list[t]],$(h.container).trigger(OGX.DynamicList.SELECT,h.filter.list[t])):(h.selected=[h.list[t]],$(h.container).trigger(OGX.DynamicList.SELECT,h.list[t]))));if($(h.list_container).find(".ogx_dynamic_list_selected_item")[0]==$(this)[0])return;return $(h.list_container).find(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item"),$(this).addClass("ogx_dynamic_list_selected_item"),void(h.filter.enabled&&y?(h.selected=[h.filter.list[t]],$(h.container).trigger(OGX.DynamicList.SELECT,h.filter.list[t])):(h.selected=[h.list[t]],$(h.container).trigger(OGX.DynamicList.SELECT,h.list[t])))}})}function a(e){for(var t=!1,i=0;i<h.selected.length;i++)if(t=h.key?e[h.key]===h.selected[i][h.key]:c(e,h.selected[i]))return h.selected.splice(i,1),!0;return!1}function o(e){for(var t=!1,i=0;i<h.selected.length;i++)if(t=h.key?e[h.key]===h.selected[i][h.key]:c(e,h.selected[i]))return!0;return!1}function c(e,t){if(h.key)return e[h.key]===t[h.key];for(var i in e)if(t[i]!==e[i])return!1;return!0}function d(e,t){var i=h.list;return i.sort(f(e,t)),i}function f(e,t){return function(i,s){return i[e]<s[e]?t*-1:i[e]>s[e]?t:0}}function m(){h||(h={});for(var e in p)h.hasOwnProperty(e)||(h[e]=p[e]);u.el=$(h.container)}function g(){m(),$(h.container).append('<ul class="ogx_dynamic_list"></ul>'),h.list_container=$(h.container).find(".ogx_dynamic_list:first"),h.list&&n(h.list),r()}var u=this,h=e,p={container:null,list_container:null,enabled:!0,selectable:!0,key:null,mode:"single",filter:{enabled:!1,list:[]},bind:{pager:null},trigger:!1,limit:10,pages:0,components:!1,list:[],selected:[],css:null},_={},y=!1;this.el=null,this.type="OgxDynamicList",this.enable=function(){h.enabled=!0},this.disable=function(){h.enabled=!1},this.setPage=function(e){h.start=h.limit*e,u.renderList()},this.setLimit=function(e){h.limit=e,u.renderList()},this.getItemPage=function(e,t){var i;if(!h.limit)return 0;var s=h.list;h.filter.enabled&&y&&(s=h.filter.list);for(var n=0;n<s.length;n++)if(s[n][e]===t)return i=Math.floor(n/h.limit)},this.setCSS=function(e){h.css&&$(h.container).find(".ogx_dynamic_list_item").removeClass(h.css),h.css=e,$(h.container).find(".ogx_dynamic_list_item").addClass(e)},this.setTemplate=function(e){h.template=e},this.getList=function(){return h.list?h.list:[]},this.setList=function(e){h.start=0,h.list=e,h.selected=[],h.filter.enabled&&y?(h.filter.list=s(),n(h.filter.list)):n(h.list),h.bind.pager&&(0===h.list.length&&h.bind.pager.setPages(1),h.bind.pager.setPage(0))},this.clearList=function(){$(h.list_container).empty()},this.bind=function(e,i,s,n){if("undefined"==typeof s||null===s)var s=i;var l;if(l=typeof e,"object"===l){if(e.hasOwnProperty("type")&&e.type)switch(e.type){case"OgxTagManager":h.filter.enabled=!0,_.hasOwnProperty(i)||(_[i]={options:{}}),l=e.getCurrentTags();var r=!1;l.length>0&&(r=!0),_[i].options[s]={obj:e,type:e.type,vals:l,include:r},$(e.el).on(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED,function(n,l){var r=e.getCurrentTags();_[i].options[s].vals=r,_[i].options[s].include=r.length>0,t()});break;case"OgxDynamicPager":h.bind.pager=e,$(e.el).on(OGX.DynamicPager.SELECT_PAGE,function(e,t){h.start=t.page*h.limit,u.renderList()}),h.bind.pager.setPages(Math.ceil(h.list.length/h.limit));break;case"OgxDynamicList":h.filter.enabled=!0,_.hasOwnProperty(i)||(_[i]={options:{}}),_[i].options[s]={obj:e,mode:n,type:e.type,vals:[],include:!1},$(e.el).on(OGX.DynamicList.SELECT+" "+OGX.DynamicList.UNSELECT,function(n,l){for(var r=e.getSelectedItems(),a=[],o=0;o<r.length;o++)a.push(r[o][s]);_[i].options[s].vals=a,_[i].options[s].include=a.length>0,t()})}}else if("string"===l&&$(e).length>0){h.filter.enabled=!0,_.hasOwnProperty(i)||(_[i]={options:{}});var a=$(e).val().trim().toLowerCase(),r=!1;switch(a.length>0&&(r=!0),_[i].options[s]={obj:$(e),type:"input",vals:[a],include:r,mode:n},$(e).attr("type").toLowerCase()){case"text":case"range":_[i].options[s].obj.on("input",function(){var e=$(this).val().trim().toLowerCase(),n=e.split(" ");_[i].options[s].vals=n;var l=_[i].options[s].include;_[i].options[s].include=n.length>0,(n.length>0!==l||n.length>0)&&t()})}}},this.unbind=function(e,t){if("undefined"==typeof t)var t=e;switch(_[e].options[t].type){case"OgxTagManager":_[e].options[t].obj.el.off(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED);break;case"OgxDynamicPager":_[e].options[t].obj.el.off(OGX.DynamicPager.SELECT_PAGE);break;case"OgxDynamicList":_[e].options[t].obj.el.off(OGX.DynamicList.SELECT+" "+OGX.DynamicList.UNSELECT);break;case"input":_[e].options[t].obj.off("input focusout")}delete _[e].options[t]},this.getSelectedItem=function(){return h.selected[0]},this.getSelectedItems=function(){return h.selected},this.getItem=function(e,t){for(var i=0;i<h.list.length;i++)if(h.list[i][e]&&h.list[i][e]===t)return h.list[i]},this.selectItems=function(e,t,i){for(var s,n=[],l=0;l<h.list.length;l++)h.list[l][e]&&h.list[l][e]===t&&(h.selected.push(h.list[l]),n.push(h.list[l]),s=l,h.bind.pager&&h.limit?s=l+h.bind.pager.getPage()*h.limit:$(h.container).find(".ogx_dynamic_list_item:eq("+l+")").addClass("ogx_dynamic_list_selected_item"));return i||u.renderList(),n},this.selectList=function(e,t,i){for(var s=0;s<h.list.length;s++)h.list[s].hasOwnProperty(e)&&t.indexOf(h.list[s][e])!==-1&&h.selected.push(h.list[s]);i||u.renderList()},this.updateSelectedItem=function(e){h.selected[0]=e,u.renderSelectedItem()},this.updateSelectedItems=function(e){if(h.key){for(var t=0;t<e.length;t++)for(var i=0;i<h.selected.length;i++)if(h.selected[i][h.key]===e[t][h.key]){h.selected[i]=e[t];break}}else for(var t=0;t<e.length;t++)h.selected[t]=e[t];u.renderSelectedItems()},this.renderSelectedItem=function(){var e=$(h.list_container).find(".ogx_dynamic_list_selected_item"),t=l(h.selected[0]);$(e).html(t)},this.renderSelectedItems=function(){var e;if(h.key)for(var t,i=0;i<h.selected.length;i++)t=h.selected[i][h.key],e=l(h.selected[i]),$(h.list_container).find(".ogx_dynamic_list_selected_item[data-"+h.key+'="'+t+'"]').html(e);else $(h.list_container).find(".ogx_dynamic_list_selected_item").each(function(t,i){e=l(h.selected[i]),$(t).html(e)})},this.resetSelection=function(){$(h.list_container).find(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item"),h.selected=[]},this.addItem=function(e,t){h.list.push(e),h.filter.enabled&&(h.filter.list=s()),t&&("multi"===h.mode?h.selected.push(e):h.selected=[e]),u.renderList()},this.addItemAt=function(e,t){if(h.list.length>0){var i=h.list.splice(0,t-1);i.push(e);var n=h.list.splice(t);h.list=i.concat(n)}else h.list.push(e);h.filter.enabled&&(h.filter.list=s()),u.renderList()},this.removeItem=function(e,t){for(var i=0;i<h.list.length;i++)if(h.list[i][e]&&h.list[i][e]===t)return h.list.splice(i,1),h.filter.enabled&&(h.filter.list=s()),u.renderList(),!0;return!1},this.removeSelectedItems=function(){for(var e;h.selected.length>0;)for(var t=0;t<h.list.length&&(e=c(h.list[t],h.selected[0]),!e||(h.list.splice(t,1),h.selected.splice(0,1),t--,0!==h.selected.length));t++);h.filter.enabled&&(h.filter.list=s()),u.renderList()},this.updateItem=function(e,t,i){for(var n=0;n<h.list.length;n++)if(h.list[n][e]===t){h.list[n]=i;break}h.filter.enabled&&(h.filter.list=s()),u.renderList()},this.renderBlock=function(e,t){t&&(h.limit=t),h.start=e*h.limit,u.renderList()},this.renderList=function(){if(h.filter.enabled){var e=s();n(e)}else n(h.list)},this.sortList=function(e,t){h.list&&(d(e,t),h.filter.enabled&&(h.filter.list=s()),u.renderList())},this.destroy=function(){i(),$(h.list_container).off("click",".ogx_dynamic_list_item")},g()},OGX.DynamicList=function(e){"use strict";return new OGX.prototype.DynamicList(e)},OGX.DynamicList.SELECT="DynamicListSelect",OGX.DynamicList.UNSELECT="DynamicListUnselect",OGX.DynamicList.FILTER="DynamicListFilter",OGX.DynamicList.RENDER="DynamicListRender";