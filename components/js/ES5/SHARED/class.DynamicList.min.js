OGX.prototype.DynamicList=function(e){"use strict";function t(){for(var e,t,n,r,s=d(),l="",a=0;a<s.length;a++)e=a,t=!1,n="",e=s[a][O.key],t=p.find(O.key,e,1),t.length&&(n="ogx_dynamic_list_selected_item"),r=i(s[a]),l+='<span class="ogx_dynamic_list_item '+n+" "+O.css+'" data-id='+e+">"+OGX.Templater.templatize(s[a],r)+"</span>";y.html(l),O.trigger&&y.trigger(OGX.DynamicList.RENDER)}function i(e){if("object"!=typeof O.template)return O.template;var t=O.template.bind;return e.hasOwnProperty(t)?O.template.templates[e[t]]:""}function n(e,i,n,r){"undefined"!=typeof n&&null!==n||(n=e),"undefined"!=typeof r&&null!==r||(r="eqjson");var l=O.list;if("object"==typeof i)switch(G[e]=i,i.__proto__.constructor){case OGX.prototype.DynamicList:G[e].el.on(OGX.DynamicList.SELECT,function(i,a){l.removeFilter(e);var o;o=G[e].mode()===OGX.DynamicList.SELECT_MODE_SINGLE||G[e].mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?G[e].getSelection()[0][n]:s(e,n),l.addFilter(e,r,o),g=l.filter(),h=!0,t()}),G[e].el.on(OGX.DynamicList.UNSELECT,function(i,a){l.removeFilter(e);var o;o=G[e].mode()===OGX.DynamicList.SELECT_MODE_SINGLE||G[e].mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?[]:s(e,n),o.length>0&&l.addFilter(e,r,o),g=l.filter(),h=!0,t()});break;case OGX.prototype.TagManager:G[e].el.on(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED,function(i,n){l.removeFilter(e),l.addFilter(e,r,G[e].getCurrentTags()),g=l.filter(),h=!0,t()});break;case OGX.prototype.Switch:G[e].el.on(OGX.Switch.TOGGLE,function(i,n){l.removeFilter(e),l.addFilter(e,r,n),g=l.filter(),h=!0,t()});break;case OGX.prototype.SwitchMulti:G[e].el.on(OGX.DynamicList.CHANGE,function(i,n){l.removeFilter(e),l.addFilter(e,r,n),g=l.filter(),h=!0,t()})}else if("string"==typeof i){if(0===$(i).length)return!1;switch(G[e]=$(i),$(i).attr("type").toLowerCase()){case"text":case"number":case"email":case"password":G[e].on("input",function(){l.removeFilter(e),l.addFilter(e,r,$(this).val()),g=l.filter(),h=!0,t()});break;case"range":var a;G[e].on("input",function(){a=Number($(this).attr("min")),l.removeFilter(e),l.addFilter(e,r,[a,$(this).val()]),g=l.filter(),h=!0,t()})}}}function r(e){if("object"==typeof G[e]){switch(G[e].__proto__.constructor){case OGX.prototype.DynamicList:G[e].el.off(OGX.DynamicList.SELECT),G[e].el.off(OGX.DynamicList.UNSELECT);break;case OGX.prototype.TagManager:G[e].el.off(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED);break;case OGX.prototype.Switch:G[e].el.off(OGX.Switch.TOGGLE);break;case OGX.prototype.SwitchMulti:G[e].el.off(OGX.DynamicList.CHANGE);break;default:G[e].off("input")}O.list.removeFilter(e),delete G[e],g=O.list.filter(),h=!0,t()}return!0}function s(e,t){for(var i=G[e].getSelection(),n=[],r=0;r<i.length;r++)n.push(i[r][t]);return n}function l(){for(var e in G)r(e)}function a(e){e?y.on("click",".ogx_dynamic_list_item",function(){switch(O.mode){case OGX.DynamicList.SELECT_MODE_SINGLE:$(this).hasClass("ogx_dynamic_list_selected_item")||(c($(this).index(),!0),y.trigger(OGX.DynamicList.SELECT,p[p.length-1]));break;case OGX.DynamicList.SELECT_MODE_TOGGLE:$(this).hasClass("ogx_dynamic_list_selected_item")?(c($(this).index(),!1),y.trigger(OGX.DynamicList.UNSELECT)):(E.resetSelection(),c($(this).index(),!0),y.trigger(OGX.DynamicList.SELECT,p[p.length-1]));break;case OGX.DynamicList.SELECT_MODE_MULTI:$(this).hasClass("ogx_dynamic_list_selected_item")?(c($(this).index(),!1),y.trigger(OGX.DynamicList.UNSELECT)):(c($(this).index(),!0),y.trigger(OGX.DynamicList.SELECT,p))}}):y.off("click",".ogx_dynamic_list_item")}function o(e,t,i){"single"===O.mode&&E.resetSelection();var n=!1;t instanceof RegExp&&(n=!0);for(var r,s=d(),l=!1,a=0;a<s.length;a++)if(!n&&s[a][e]===t&&(p.push(s[a]),r=y.find(".ogx_dynamic_list_item[data-id="+s[a][O.key]+"]:first"),i?r.addClass("ogx_dynamic_list_selected_item"):r.removeClass("ogx_dynamic_list_selected_item"),l=!0,"single"===O.mode))return l;return l}function c(e,t){var i,n=d();if(i=y.find(".ogx_dynamic_list_item:eq("+e+")"),i.length>0){if(O.mode===OGX.DynamicList.SELECT_MODE_SINGLE&&E.resetSelection(),t)i.addClass("ogx_dynamic_list_selected_item"),h?p.push(n[e]):p.push(n[e]);else{i.removeClass("ogx_dynamic_list_selected_item");p.findDelete(O.key,i.data("id"),1)}return!0}return!1}function d(){return h?g:O.list}function f(){for(var e=0;e<O.list.length;e++)O.list[e].__id__=X,X++}function m(e){for(var t=0;t<e.length;t++)delete e[t].__id__;return e}function _(){O||(O={});for(var e in L)O.hasOwnProperty(e)||(O[e]=L[e]);O.list.length>0&&!O.list.hasOwnProperty("insert")&&(O.list=new OGX.List(O.list)),!O.key&&O.list.length>0&&(f(),O.key="__id__",D=!0),$(O.container).append('<div class="ogx_dynamic_list"></div>'),E.el=y=$(O.container).children(".ogx_dynamic_list:first")}function u(){return"undefined"==typeof OGX.Templater?void console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000"):"undefined"==typeof OGX.List?void console.log("%c CRITICAL ERROR - OGX.List not found! ","background:#222; color: #FF0000"):(_(),E.val(O.list),t(),void(O.enabled&&a(!0)))}var y,g,h,E=this,O=e,L={container:null,enabled:!0,key:!1,template:"",list:[],mode:OGX.DynamicList.SELECT_MODE_SINGLE,render_mode:OGX.DynamicList.RENDER_MODE_SIMPLE,trigger:!1,css:""},p=new OGX.List,G={},D=!1,X=1;this.el=null,this.val=function(e){if("undefined"==typeof e){if(D){var i=JSON.parse(JSON.stringify(O.list));return m(i)}return O.list}e.hasOwnProperty("insert")||(e=new OGX.List(e)),O.list=e,t()},this.template=function(e){return"undefined"==typeof e?O.template:(O.template=e,!0)},this.mode=function(e){return"undefined"==typeof e?O.mode:(O.mode=e,!0)},this.enable=function(){return!O.enabled&&(O.enabled=!0,a(!0),!0)},this.disable=function(){return!!O.enabled&&(O.enabled=!1,a(!1),!0)},this.bind=function(e,t,i,r){return!G.hasOwnProperty(e)&&n(e,t,i,r)},this.unbind=function(e){return!!G.hasOwnProperty(e)&&r(e)},this.order=function(e,i){O.list.order(e,i),t()},this.filter=function(){g=O.list.filter(),h=!0,t()},this.unfilter=function(){h=!1,t()},this.addFilter=function(e,t,i){return O.list.addFilter(e,t,i)},this.removeFilter=function(e,t,i){return O.list.removeFilter(e,t,i)},this.resetFilters=function(){return O.list.resetFilters()},this.getFilters=function(){return O.list.getFilters()},this.insert=function(e,t){D&&(e.__id__=X++);var n,r=!0;if(h){var s=new OGX.List(e);s.setFilters(O.list.getFilters()),0===s.filter().length&&(r=!1)}var l=i(e),a='<span class="ogx_dynamic_list_item '+O.css+'" data-id='+e[O.key]+">"+OGX.Templater.templatize(e,l)+"</span>";if("undefined"==typeof t)O.list.push(e),r&&y.append(a);else if(O.list.insert(e,t),r){if(h)g=O.list.filter(),n=g.findIndex(O.key,e[O.key]);else{if(0===t)return y.prepend(a),!0;n=O.list.findIndex(O.key,e[O.key])}var o=y.children(".ogx_dynamic_list_item:nth-child("+(n.index+1)+")");o.length>0?o.before(a):y.append(a),O.trigger&&y.trigger(OGX.DynamicList.RENDER)}return r},this.delete=function(e){return O.list.delete(e)&&y.children(".ogx_dynamic_list_item:eq("+e+")").remove(),!0},this.deleteSelection=function(){for(var e=d(),t=0;t<p.length;t++)e.findDelete(O.key,p[t][O.key],1),y.children(".ogx_dynamic_list_selected_item").remove();return!0},this.findDelete=function(e,t,i){for(var n=O.list.findDelete(e,t,i),r=0;r<n.length;r++)y.children(".ogx_dynamic_list_item[data-id="+n[r][O.key]+"]:first").remove();return n.length},this.select=function(e,t){return o(e,t,!0)},this.selectIndex=function(e){return c(e,!0)},this.unselect=function(e,t){return o(e,t,!1)},this.unselectIndex=function(e){return c(e,!1)},this.resetSelection=function(){p=new OGX.List,y.children(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item")},this.getSelection=function(){if(D){var e=JSON.parse(JSON.stringify(p));return m(e)}return p},this.replace=function(e,t,n){D&&(n.__id__=X++);var r=O.list.findReplace(e,t,n,1);if(r.length>0){var s=y.children(".ogx_dynamic_list_item[data-id="+r[0][O.key]+"]:first"),l=i(n),a=OGX.Templater.templatize(n,l);return s.attr("data-id",n[O.key]),s.html(a),O.trigger&&y.trigger(OGX.DynamicList.RENDER),!0}return!1},this.update=function(e,t,n,r,s){var l,a,o=O.list.findUpdate(e,t,n,r,s);if(o.length>0){for(var c,d=0;d<o.length;d++)l=y.children(".ogx_dynamic_list_item[data-id="+o[d][O.key]+"]:first"),l.length>0&&(c=i(o[d]),a=OGX.Templater.templatize(o[d],c),l.html(a),O.trigger&&y.trigger(OGX.DynamicList.RENDER));return o.length}return!1},this.clear=function(){y.empty()},this.reset=function(){y.empty(),h=!1,O.list=new OGX.List,p=new OGX.List,g=new OGX.List},this.destroy=function(){l(),O.enabled&&a(!1),y.empty(),y.removeClass("ogx_dynamic_list")},this.render=function(){t()},u()},OGX.DynamicList=function(e){"use strict";return new OGX.prototype.DynamicList(e)},OGX.DynamicList.SELECT="DynamicListSelect",OGX.DynamicList.UNSELECT="DynamicListUnselect",OGX.DynamicList.RENDER="DynamicListRender",OGX.DynamicList.SELECT_MODE_SINGLE="single",OGX.DynamicList.SELECT_MODE_TOGGLE="toggle",OGX.DynamicList.SELECT_MODE_MULTI="multi",OGX.DynamicList.RENDER_MODE_SIMPLE="DynamicListRenderModeSimple",OGX.DynamicList.RENDER_MODE_SCROLL="DynamicListRenderModeScroll";