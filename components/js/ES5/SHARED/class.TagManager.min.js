if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.TagManager=function(a){"use strict";function n(a){var n=!1;switch(T.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:T.currentTags.indexOf(a)===-1&&(T.currentTags.push(a),n=!0);break;case OGX.TagManager.MODE_OBJECT:var e=T.currentTags.find("label",a,1);0===e.length&&(e=T.tags.find("label",a,1),e?T.currentTags.push(e[0]):T.currentTags.push({label:a}),n=!0)}if(n){var t="";T.editable===!0?t='<img src="'+T.image+'">':null;var r='<span class="ogx_tag_manager_tag"><span>'+a+"</span>"+t+"</span>";$(T.container).find(".ogx_tag_manager_tags:first").append(r),$(T.container).trigger(OGX.TagManager.TAG_ADDED,a)}$(T.container).find(".ogx_tag_manager_input:first").focus()}function e(a){var n=!1,e=!1;switch(T.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:var t=T.currentTags.indexOf(a);t>-1&&(T.currentTags.splice(t,1),n=!0);break;case OGX.TagManager.MODE_OBJECT:n=T.currentTags.findDelete("label",a)}return n&&$(T.container).find(".ogx_tag_manager_tags:first").find(".ogx_tag_manager_tag").each(function(n,t){if($(t).find("span:first").text()===a)return $(t).remove(),void(e=!0)}),e}function t(a,n){if(a){$(T.container).find(".ogx_tag_manager_tags_container:first").length>0&&(t(!1),_(!1));for(var e='<div class="ogx_tag_manager_tags_container">',r=0;r<n.length;r++)switch(T.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:e+='<span class="ogx_tag_manager_tag ogx_tag_manager_tags_container_tag">'+n[r]+"</span>";break;case OGX.TagManager.MODE_OBJECT:e+='<span class="ogx_tag_manager_tag ogx_tag_manager_tags_container_tag">'+n[r].label+"</span>"}e+="</div>",$(T.container).append(e),_(!0)}else $(T.container).find(".ogx_tag_manager_tags_container").remove(),_(!1)}function r(a){for(var n="",e="",t=0;t<a.length;t++)switch(e=T.editable===!0?'<img src="'+T.image+'">':"",T.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:n+='<span class="ogx_tag_manager_tag"><span>'+a[t]+"</span>"+e+"</span>";break;case OGX.TagManager.MODE_OBJECT:n+='<span class="ogx_tag_manager_tag"><span>'+a[t].label+"</span>"+e+"</span>"}return T.currentTags=a,$(T.container).find(".ogx_tag_manager_tags:first").html(n),!0}function g(a){var n=[];a=a.substr(0,3);for(var e=0;e<T.tags.length;e++)0===T.tags[e].toLowerCase().indexOf(a.toLowerCase())&&T.currentTags.indexOf(T.tags[e])===-1&&n.push(T.tags[e]);return n}function i(a){for(var n=new RegExp(a,"gi"),e=T.tags.find("label",n),t=0;t<T.currentTags.length;t++)e.findDelete("label",T.currentTags[t].label);return e}function s(a){var n=a.substr(0,3),e=o(n),t=[];if(T.tagsAscii[e])for(var r=0;r<T.tagsAscii[e].length;r++)T.tagsAscii[e][r].toLowerCase().indexOf(a.toLowerCase())!==-1&&T.currentTags.indexOf(T.tags[r])===-1&&t.push(T.tagsAscii[e][r]);return t}function o(a){for(var n="",e=0;e<a.length;e++)n+=a.toLowerCase().charCodeAt(e).toString();return n}function c(a){a?$(T.container).find(".ogx_tag_manager_input:first").on("keyup",function(a){var e=$(this).val();if(e.length>=3)if(a.which===T.keycode&&T.add_new)n(e),$(T.container).find(".ogx_tag_manager_input:first").val(""),t(!1);else{var r;switch(T.mode){case OGX.TagManager.MODE_STRING:r=g(e);break;case OGX.TagManager.MODE_OBJECT:r=i(e);break;case OGX.TagManager.MODE_ASCII:r=s(e)}r.length>0?t(!0,r):t(!1)}else t(!1)}):$(T.container).find(".ogx_tag_manager_input:first").off("keyup")}function _(a){a?$(T.container).find(".ogx_tag_manager_tags_container:first").on("click",".ogx_tag_manager_tags_container_tag",function(){var a=$(this).text();n(a),$(T.container).find(".ogx_tag_manager_input:first").val(""),t(!1)}):$(T.container).find(".ogx_tag_manager_tags_container:first").off("click",".ogx_tag_manager_tags_container_tag")}function f(a){a?$(T.container).on("click",".ogx_tag_manager_tags img",function(){var a=$(this).parent("span:first").find("span:first").text();e(a),$(T.container).trigger(OGX.TagManager.TAG_REMOVED,a),$(T.container).find(".ogx_tag_manager_input:first").focus()}):$(T.container).off("click",".ogx_tag_manager_tags")}function u(){$(T.container).addClass("ogx_tag_manager"),$(T.container).html('<span class="ogx_tag_manager_tags"></span><input type="text" class="ogx_tag_manager_input" placeholder="'+T.placeholder+'">')}function d(){T||(T={});for(var a in h)T.hasOwnProperty(a)||(T[a]=h[a]);T.tags.hasOwnProperty("insert")||(T.tags=new OGX.List(T.tags)),T.currentTags.hasOwnProperty("insert")||(T.currentTags=new OGX.List(T.currentTags)),p.el=O=$(T.container)}function l(){return"undefined"==typeof OGX.List?void console.log("%c CRITICAL ERROR - OGX.List not found! ","background:#222; color: #FF0000"):(d(),u(),T.enabled&&T.editable?(T.enabled=!1,p.enable()):(T.enabled=!0,p.disable()),void(T.currentTags.length>0&&r(T.currentTags)))}var O,p=this,T=a,h={editable:!1,add_new:!0,tags:[],currentTags:[],tagsAscii:[],image:"/images/ogx/tag_remove.png",mode:OGX.TagManager.MODE_STRING,keycode:13,placeholder:"keywords",enabled:!0};this.el=null,this.enable=function(){T.enabled||(T.enabled=!0,c(!0),_(!0),f(!0),$(T.container).find(".ogx_tag_manager_input:first").prop("placeholder",T.placeholder),$(T.container).find(".ogx_tag_manager_input:first").prop("disabled",!1))},this.disable=function(){T.enabled&&(T.enabled=!1,c(!1),_(!1),f(!1),$(T.container).find(".ogx_tag_manager_input:first").prop("placeholder",""),$(T.container).find(".ogx_tag_manager_input:first").prop("disabled",!0))},this.setTags=function(a){return a.hasOwnProperty("insert")||(a=new OGX.List(a)),T.tags=a,!0},this.getTags=function(){return T.tags},this.getCurrentTags=function(){return T.currentTags},this.setCurrentTags=function(a){return a.hasOwnProperty("insert")||(a=new OGX.List(a)),T.currentTags=a,r(T.currentTags)},this.showTags=function(a){return r(a)},this.addTag=function(a){return n(a)},this.removeTag=function(a){return e(a)},this.destroy=function(){c(!1),_(!1),f(!1)},l()},OGX.TagManager=function(a){"use strict";return new OGX.prototype.TagManager(a)},OGX.TagManager.tagDataset=function(a,n,e){"use strict";"undefined"==typeof e&&(e=!1);for(var t,r=[],g=0;g<a.length;g++)for(var i=0;i<n.length;i++)if(a[g].hasOwnProperty(n[i])){t=a[g][n[i]].split(" ");for(var s=0;s<t.length;s++)e&&e.indexOf(t[s])!==-1||r.indexOf(t[s])===-1&&r.push(t[s])}return r},OGX.TagManager.tagDatatree=function(a,n){"use strict";function e(a,n){function e(a){if(a.hasOwnProperty("items"))for(var r=0;r<a.items.length;r++){for(var g in a.items[r])n.indexOf(g)>-1&&t.indexOf(a.items[r][g])===-1&&t.push(a.items[r][g]);return e(a.items[r]),!0}}var t=[],r=e(a);if(r)return t}e(a,n)},OGX.TagManager.TAG_ADDED="tagAdded",OGX.TagManager.TAG_REMOVED="tagRemoved",OGX.TagManager.MODE_STRING="modeString",OGX.TagManager.MODE_OBJECT="modeObject",OGX.TagManager.MODE_ASCII="modeAscii";