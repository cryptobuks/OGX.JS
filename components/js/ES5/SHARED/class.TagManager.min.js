if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.TagManager=function(a){"use strict";function n(a){if(p.currentTags.indexOf(a)===-1){p.currentTags.push(a);var n="";p.editable===!0?n='<img src="'+p.image+'">':null;var t='<span class="ogx_tag_manager_tag"><span>'+a+"</span>"+n+"</span>";$(p.container).find(".ogx_tag_manager_tags:first").append(t),$(p.container).trigger(OGX.TagManager.TAG_ADDED,a),$(p.container).find(".ogx_tag_manager_input:first").focus()}}function t(a){var n=p.currentTags.indexOf(a);return n>-1&&(p.currentTags.splice(n,1),$(p.container).find(".ogx_tag_manager_tags:first").find(".ogx_tag_manager_tag").each(function(n,t){if($(t).find("span:first").text()===a)return $(t).remove(),!0})),!1}function e(a,n){if(a){$(p.container).find(".ogx_tag_manager_tags_container:first").length>0&&(e(!1),c(!1));for(var t='<div class="ogx_tag_manager_tags_container">',r=0;r<n.length;r++)t+='<span class="ogx_tag_manager_tag ogx_tag_manager_tags_container_tag">'+n[r]+"</span>";t+="</div>",$(p.container).append(t),c(!0)}else $(p.container).find(".ogx_tag_manager_tags_container").remove(),c(!1)}function r(a){for(var n="",t="",e=0;e<a.length;e++)t=p.editable===!0?'<img src="'+p.image+'">':"",n+='<span class="ogx_tag_manager_tag"><span>'+a[e]+"</span>"+t+"</span>";return p.currentTags=a,$(p.container).find(".ogx_tag_manager_tags:first").html(n),!0}function i(a){var n=[];a=a.substr(0,3);for(var t=0;t<p.tags.length;t++)0===p.tags[t].toLowerCase().indexOf(a.toLowerCase())&&p.currentTags.indexOf(p.tags[t])===-1&&n.push(p.tags[t]);return n}function g(a){var n=a.substr(0,3),t=s(n),e=[];if(p.tagsAscii[t])for(var r=0;r<p.tagsAscii[t].length;r++)p.tagsAscii[t][r].toLowerCase().indexOf(a.toLowerCase())!==-1&&p.currentTags.indexOf(p.tags[r])===-1&&e.push(p.tagsAscii[t][r]);return e}function s(a){for(var n="",t=0;t<a.length;t++)n+=a.toLowerCase().charCodeAt(t).toString();return n}function o(a){a?$(p.container).find(".ogx_tag_manager_input:first").on("keyup",function(a){var t=$(this).val();if(t.length>=3)if(a.which===p.keycode)n(t),$(p.container).find(".ogx_tag_manager_input:first").val(""),e(!1);else{var r;switch(p.mode){case OGX.TagManager.MODE_STRING:r=i(t);break;case OGX.TagManager.MODE_ASCII:r=g(t)}r.length>0?e(!0,r):e(!1)}else e(!1)}):$(p.container).find(".ogx_tag_manager_input:first").off("keyup")}function c(a){a?$(p.container).find(".ogx_tag_manager_tags_container:first").on("click",".ogx_tag_manager_tags_container_tag",function(){var a=$(this).text();n(a),$(p.container).find(".ogx_tag_manager_input:first").val(""),e(!1)}):$(p.container).find(".ogx_tag_manager_tags_container:first").off("click",".ogx_tag_manager_tags_container_tag")}function f(a){a?$(p.container).on("click",".ogx_tag_manager_tags img",function(){var a=$(this).parent("span:first").find("span:first").text();t(a),$(p.container).trigger(OGX.TagManager.TAG_REMOVED,a),$(p.container).find(".ogx_tag_manager_input:first").focus()}):$(p.container).off("click",".ogx_tag_manager_tags")}function _(){$(p.container).addClass("ogx_tag_manager"),$(p.container).html('<span class="ogx_tag_manager_tags"></span><input type="text" class="ogx_tag_manager_input" placeholder="'+p.placeholder+'">')}function u(){p||(p={});for(var a in m)p.hasOwnProperty(a)||(p[a]=m[a]);l.el=$(p.container)}function d(){u(),_(),p.enabled&&p.editable?(p.enabled=!1,l.enable()):(p.enabled=!0,l.disable())}var l=this,p=a,m={editable:!1,tags:[],currentTags:[],tagsAscii:[],image:"/images/ogx/tag_remove.png",mode:OGX.TagManager.MODE_STRING,keycode:13,placeholder:"keywords",enabled:!0};this.el=null,this.enable=function(){p.enabled||(p.enabled=!0,o(!0),c(!0),f(!0),$(p.container).find(".ogx_tag_manager_input:first").prop("placeholder",p.placeholder),$(p.container).find(".ogx_tag_manager_input:first").prop("disabled",!1))},this.disable=function(){p.enabled&&(p.enabled=!1,o(!1),c(!1),f(!1),$(p.container).find(".ogx_tag_manager_input:first").prop("placeholder",""),$(p.container).find(".ogx_tag_manager_input:first").prop("disabled",!0))},this.setTags=function(a){return p.tags=a,!0},this.getTags=function(){return p.tags},this.getCurrentTags=function(){return p.currentTags},this.setCurrentTags=function(a){return p.currentTags=a,r(p.currentTags)},this.showTags=function(a){return r(a)},this.addTag=function(a){return n(a)},this.removeTag=function(a){return t(a)},this.destroy=function(){o(!1),c(!1),f(!1)},d()},OGX.TagManager=function(a){"use strict";return new OGX.prototype.TagManager(a)},OGX.TagManager.tagDataset=function(a,n,t){"use strict";"undefined"==typeof t&&(t=!1);for(var e,r=[],i=0;i<a.length;i++)for(var g=0;g<n.length;g++)if(a[i].hasOwnProperty(n[g])){e=a[i][n[g]].split(" ");for(var s=0;s<e.length;s++)t&&t.indexOf(e[s])!==-1||r.indexOf(e[s])===-1&&r.push(e[s])}return r},OGX.TagManager.tagDatatree=function(a,n){"use strict";function t(a,n){function t(a){if(a.hasOwnProperty("items"))for(var r=0;r<a.items.length;r++){for(var i in a.items[r])n.indexOf(i)>-1&&e.indexOf(a.items[r][i])===-1&&e.push(a.items[r][i]);return t(a.items[r]),!0}}var e=[],r=t(a);if(r)return e}t(a,n)},OGX.TagManager.TAG_ADDED="tagAdded",OGX.TagManager.TAG_REMOVED="tagRemoved",OGX.TagManager.MODE_STRING="modeString",OGX.TagManager.MODE_ASCII="modeAscii";