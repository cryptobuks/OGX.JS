if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.MobileActivityCalendar=function(t){"use strict";function a(t){return t.hasOwnProperty("originalEvent")?t.originalEvent.changedTouches[0]:t}function i(t){t?$(window).on("resize",function(){var t=G.innerWidth(),a=_(k);k.css({transform:"translate3D("+(Number(a[0])-Math.abs(F.width-t))+"px, 0px, 0px)"}),F.width=t,$(".ogx_mobile_activity_calendar_days").css("width",3*F.width),$(".ogx_mobile_activity_calendar_day").css("width",F.width)}):$(window).off("resize")}function e(t){t?k.on(Y,function(t){R=!1,I=0,B=(new Date).getTime(),t=a(t),z.x=t.pageX,z.y=t.pageY+k.parent(0).scrollTop(),e(!1),n(!0),o(!0)}):k.off(Y)}function n(t){t?k.on(S,function(t){n(!1),o(!1),K||e(!0)}):k.off(S)}function r(t){if(t){var i=!1;G.on(S,".ogx_mobile_activity_calendar_block",function(t){if(i=!1,t=a(t),Math.abs(z.x-t.pageX)<2&&Math.abs(z.y-t.pageY)<2&&(F.maxT?(new Date).getTime()-B<F.maxT&&(i=!0):i=!0),i){var e=v($(this));e.date=F.date,G.trigger(OGX.MobileActivityCalendar.SELECT,e)}})}else G.off(S,".ogx_mobile_activity_calendar_block")}function o(t){t?(l(!0),k.on(N,function(t){t=a(t),R=!1,I=0,Math.abs(t.pageX-z.x)>Math.abs(t.pageY-z.y)&&(R=Math.abs(t.pageX-z.x),I=t.pageX-z.x>0?1:-1)})):(l(!1),k.off(N))}function l(t){t?q||(q=setInterval(d,10)):q&&(clearInterval(q),q=null)}function d(){if(R&&I&&R>F.minX){L=F.width,L*=I,o(!1),c(!0),e(!1),K=!0,k.addClass("ogx_mobile_activity_anim");var t=_(k);k.css({transform:"translate3D("+(Number(t[0])+L)+"px, 0px, 0px)"})}}function c(t){t?k.on("transitionend",function(t){c(!1),G.trigger(OGX.MobileActivityCalendar.DAY_CHANGE,F.date),k.removeClass("ogx_mobile_activity_anim"),I===-1?h():m(),K=!1,e(!0)}):k.off("transitionend")}function _(t){var a=t.css("-webkit-transform").match(/matrix(?:(3d)\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}\d+))(?:, (-{0,1}\d+))(?:, (-{0,1}\d+)), -{0,1}\d+\)|\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}\d+))(?:, (-{0,1}\d+))\))/);return a?"3d"==a[1]?a.slice(2,5):(a.push(0),a.slice(5,8)):[0,0,0]}function s(t,a){var i=t.split(":"),e=Number(i[0]),n=Number(i[1]),r=k.find('.ogx_mobile_activity_calendar_hour[data-hour="'+e+'"]:first').position().top;r+=Math.round(n/60*T);var o=Math.ceil(Number(a.length)/60*T);return{y:r,h:o}}function v(t){var a={};return a.type=t.data("type"),a.category=F.data.categories[a.type],a.label=t.find("span:first").text(),a.start=t.data("start"),a.length=t.data("length"),a}function f(t,a){return Math.max(t.top,a.top)<Math.min(t.bottom,a.bottom)}function y(t,a){var i,e,n,r,o,l,d,c,_,s;if(i=t.find(".ogx_mobile_activity_calendar_grid:first").height(),n=t.children(".ogx_mobile_activity_calendar_content:first"),e=n.children(".ogx_mobile_activity_calendar_stripe").length,e>0)for(var v=0;v<e;v++){if(r=n.children(".ogx_mobile_activity_calendar_stripe:eq("+v+")"),l=r.children(".ogx_mobile_activity_calendar_block").length,s=!0,!(l>0))return r;for(var y=0;y<l;y++)o=r.children(".ogx_mobile_activity_calendar_block:eq("+y+")"),d=o.position().top,c=o.height(),_=f({top:a.y,bottom:a.y+a.h},{top:d,bottom:d+c}),_&&(s=!1);if(s)return r}return n.append('<div class="ogx_mobile_activity_calendar_stripe" style="height:'+i+'px;"></div>'),n.children(".ogx_mobile_activity_calendar_stripe:last")}function m(){var t=g(F.date);F.date=t;var a=k.find(".ogx_mobile_activity_calendar_day:last").detach(),i=g(F.date);a.children(".ogx_mobile_activity_calendar_nav:first").text(i.toString().substr(0,15)),a.find(".ogx_mobile_activity_calendar_content:first").empty(),k.prepend(a);var e=b(i);e&&x(e,i.getDay(),k.find(".ogx_mobile_activity_calendar_day:first"));var n=_(k);k.css({transform:"translate3D("+(Number(n[0])-F.width)+"px, 0px, 0px)"})}function h(){var t=u(F.date);F.date=t;var a=k.find(".ogx_mobile_activity_calendar_day:first").detach(),i=u(F.date);a.children(".ogx_mobile_activity_calendar_nav:first").text(i.toString().substr(0,15)),a.find(".ogx_mobile_activity_calendar_content:first").empty(),k.append(a);var e=b(i);e&&x(e,i.getDay(),k.find(".ogx_mobile_activity_calendar_day:last"));var n=_(k);k.css({transform:"translate3D("+(Math.abs(n[0])-F.width)*-1+"px, 0px, 0px)"})}function u(t){var a=new Date(t.toString());return new Date(a.getFullYear(),a.getMonth(),a.getDate()+1)}function g(t){var a=new Date(t.toString());return new Date(a.getFullYear(),a.getMonth(),a.getDate()-1)}function b(t){var a,i;for(var e in F.data.calendar)if(a=e.split("_"),a[0]=moment(a[0]+" 00:00:00").unix(),a[1]=moment(a[1]+" 23:59:59").unix(),i=moment(t).unix(),i>=a[0]&&i<=a[1])return F.data.calendar[e];return!1}function p(){P.el.find(".ogx_mobile_activity_calendar_content").empty();var t,a,i=F.date.getDay(),e=i-1,n=moment(F.date).subtract(1,"day");e<0?e=6:null;for(var r=0;r<3;r++)a=b(n.format("YYYY-MM-DD")),a&&(t=G.children(".ogx_mobile_activity_calendar_days:first").children(".ogx_mobile_activity_calendar_day:eq("+r+")"),x(a,e,t)),e++,e>6?e=0:null,n.add(1,"day");P.el.trigger(OGX.MobileActivityCalendar.RENDER)}function x(t,a,i){var e,n,r,o,l;C();for(var d in t[a])for(var c=0;c<t[a][d].length;c++)r=t[a][d][c],e=s(d,r),o=y(i,e),l=F.data.categories[r.type].color,n='<div class="ogx_mobile_activity_calendar_block" style="top:'+e.y+"px; height:"+e.h+"px; background-color:"+l+';" data-start="'+d+'" data-length="'+r.length+'" data-type="'+r.type+'"><span>'+r.label+"</span></div>",o.append(n);var _=i.find(".ogx_mobile_activity_calendar_content:first").children(".ogx_mobile_activity_calendar_stripe").length,v=Math.floor(F.width/_);i.find(".ogx_mobile_activity_calendar_content:first").children(".ogx_mobile_activity_calendar_stripe").each(function(t,a){$(a).css("width",v+"px")})}function M(){switch(F.mode){case OGX.MobileActivityCalendar.MODE_MOBILE:Y="touchstart",S="touchend",N="touchmove";break;case OGX.MobileActivityCalendar.MODE_DESKTOP:Y="mousedown",S="mouseup",N="mousemove"}}function w(){for(var t=0;t<3;t++)O(t)}function D(t,a){switch(a){case 1:t<=11?t+="<span>am</span>":12===t?t+="<span>pm</span>":t=t-12+"<span>pm</span>";break;case 2:t<10?t="0"+t:null}return t}function O(t){for(var a,i,e=G.height()-k.find(".ogx_mobile_activity_calendar_nav:first").height(),n=F.day_end-F.day_start+1,r=Math.floor(e/n),o="",l=k.children(".ogx_mobile_activity_calendar_day:eq("+t+")").children(".ogx_mobile_activity_calendar_grid:first"),d=0;d<n;d++)a=F.day_start+d,i=F.ampm?D(a,1):D(a,2),o+='<div class="ogx_mobile_activity_calendar_hour" data-hour="'+a+'" style="height:'+r+'px;"><span class="ogx_mobile_activity_calendar_hour_label">'+i+"</span></div>";l.html(o),T=l.find(".ogx_mobile_activity_calendar_hour:first").height()}function C(){for(var t=[g(F.date),F.date,u(F.date)],a=G.find(".ogx_mobile_activity_calendar_days:first"),i=0;i<3;i++)a.children(".ogx_mobile_activity_calendar_day:eq("+i+")").children(".ogx_mobile_activity_calendar_nav:first").html(t[i].toString().substr(0,15))}function E(){for(var t=G.width(),a=0,i='<div class="ogx_mobile_activity_calendar_days" style="width:'+3*t+'px;">',e=0;e<3;e++)i+='<div class="ogx_mobile_activity_calendar_day" style="width:'+t+'px;">',i+='<div class="ogx_mobile_activity_calendar_nav"></div>',i+='<div class="ogx_mobile_activity_calendar_grid"></div>',i+='<div class="ogx_mobile_activity_calendar_content"></div>',i+="</div>",a+=t;i+="</div>",G.append(i),k=G.find(".ogx_mobile_activity_calendar_days:first"),k.css({transform:"translate3D("+-F.width+"px, 0, 0)"})}function X(){for(var t in H)F.hasOwnProperty(t)||(F[t]=H[t]);F.width=$(F.container).innerWidth(),F.height=$(F.container).innerHeight(),P.el=G=$(F.container),G.addClass("ogx_mobile_activity_calendar ogx_hw")}function A(){X(),M(),E(),C(),w(),F.data&&setTimeout(p,250),e(!0),r(!0),i(!0)}var G,k,T,Y,S,N,R,I,L,q,B,P=this,F=t,H={day_start:6,day_end:21,date:new Date,ampm:!0,data:!1,mode:OGX.MobileActivityCalendar.MODE_MOBILE,minX:60,maxY:5,maxT:100},z={},K=!1;this.el=null,this.setData=function(t,a){if("undefined"==typeof a)var a=!0;F.data=t,a&&p()},this.setDate=function(t){F.date=t,p()},this.render=function(){p()},this.addBlock=function(t,a){var i;i="undefined"==typeof a?b(__date):F.data.calendar[a]={0:null,1:null,2:null,3:null,4:null,5:null,6:null};var e=moment(t.date).day();return i[e]||(i[e]={}),i[e][t.start]||(i[e][t.start]=[]),i[day][t.start].push(t),p(),!0},this.removeBlock=function(t){var a=b(t.date);if(a){var i=moment(t.date).day();if(a[i].hasOwnProperty(t.start))for(var e=0;e<a[i][t.start].length;e++)if(a[i][t.start][e].type===t.type&&a[i][t.start][e].label===t.label)return a[i][t.start].splice(e,1),p(),!0}return!1},this.destroy=function(){e(!1),n(!1),o(!1),c(!1),i(!1)},A()},OGX.MobileActivityCalendar=function(t){"use strict";return"undefined"==typeof moment?void console.log("%c CRITICAL ERROR - momentJS not found! ","background:#222; color: #FF0000"):new OGX.prototype.MobileActivityCalendar(t)},OGX.MobileActivityCalendar.MODE_DESKTOP="desktop",OGX.MobileActivityCalendar.MODE_MOBILE="mobile",OGX.MobileActivityCalendar.SELECT="MobileActivityCalendarSelect",OGX.MobileActivityCalendar.DAY_CHANGE="MobileActivityCalendarDayChange",OGX.MobileActivityCalendar.RENDER="MobileActivityCalendarRender";