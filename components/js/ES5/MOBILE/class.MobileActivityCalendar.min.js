if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.MobileActivityCalendar=function(t){"use strict";function a(t){return t.hasOwnProperty("originalEvent")?t.originalEvent.changedTouches[0]:t}function i(t){t?$(window).on("resize",function(){var t=$(window).innerWidth(),a=_(G);G.css({transform:"translate3D("+(Number(a[0])-Math.abs(B.width-t))+"px, 0px, 0px)"}),B.width=t,$(".ogx_mobile_activity_calendar_days").css("width",3*B.width),$(".ogx_mobile_activity_calendar_day").css("width",B.width)}):$(window).off("resize")}function e(t){t?G.on(k,function(t){Y=!1,I=0,q=(new Date).getTime(),t=a(t),z.x=t.pageX,z.y=t.pageY+G.parent(0).scrollTop(),e(!1),n(!0),r(!0)}):G.off(k)}function n(t){t?G.on(N,function(t){n(!1),r(!1),F||e(!0)}):G.off(N)}function o(t){t?A.on(N,".ogx_mobile_activity_calendar_block",function(t){if(console.log("item up",(new Date).getTime()-q),(new Date).getTime()-q<B.maxT){console.log("block was clicked");var a=v($(this));A.trigger(OGX.MobileActivityCalendar.SELECT,a)}}):A.off(N,".ogx_mobile_activity_calendar_block")}function r(t){t?(c(!0),G.on(S,function(t){t=a(t),Y=!1,I=0,Math.abs(t.pageX-z.x)>Math.abs(t.pageY-z.y)&&(Y=Math.abs(t.pageX-z.x),I=t.pageX-z.x>0?1:-1)})):(c(!1),G.off(S))}function c(t){t?R||(R=setInterval(l,10)):R&&(clearInterval(R),R=null)}function l(){if(Y&&I&&Y>B.minX){L=B.width,L*=I,r(!1),d(!0),e(!1),F=!0,G.addClass("ogx_mobile_activity_anim");var t=_(G);G.css({transform:"translate3D("+(Number(t[0])+L)+"px, 0px, 0px)"})}}function d(t){t?G.on("transitionend",function(t){d(!1),A.trigger(OGX.MobileActivityCalendar.DAY_CHANGE,B.date),G.removeClass("ogx_mobile_activity_anim"),I===-1?h():y(),F=!1,e(!0)}):G.off("transitionend")}function _(t){var a=t.css("-webkit-transform").match(/matrix(?:(3d)\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}\d+))(?:, (-{0,1}\d+))(?:, (-{0,1}\d+)), -{0,1}\d+\)|\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}\d+))(?:, (-{0,1}\d+))\))/);return a?"3d"==a[1]?a.slice(2,5):(a.push(0),a.slice(5,8)):[0,0,0]}function s(t,a){var i=t.split(":"),e=Number(i[0]),n=Number(i[1]),o=G.find('.ogx_mobile_activity_calendar_hour[data-hour="'+e+'"]:first').position().top;o+=Math.round(n/60*T);var r=Math.ceil(Number(a.length)/60*T);return{y:o,h:r}}function v(t){var a={};return a.type=t.data("type"),a.category=B.data.categories[a.type],a.label=t.find("span:first").text(),a.start=t.data("start"),a.length=t.data("length"),a}function f(t,a){return Math.max(t.top,a.top)<Math.min(t.bottom,a.bottom)}function g(t,a){var i,e,n,o,r,c,l,d,_,s;if(i=t.find(".ogx_mobile_activity_calendar_grid:first").height(),n=t.children(".ogx_mobile_activity_calendar_content:first"),e=n.children(".ogx_mobile_activity_calendar_stripe").length,e>0)for(var v=0;v<e;v++){if(o=n.children(".ogx_mobile_activity_calendar_stripe:eq("+v+")"),c=o.children(".ogx_mobile_activity_calendar_block").length,s=!0,!(c>0))return o;for(var g=0;g<c;g++)r=o.children(".ogx_mobile_activity_calendar_block:eq("+g+")"),l=r.position().top,d=r.height(),_=f({top:a.y,bottom:a.y+a.h},{top:l,bottom:l+d}),_&&(s=!1);if(s)return o}return n.append('<div class="ogx_mobile_activity_calendar_stripe" style="height:'+i+'px;"></div>'),n.children(".ogx_mobile_activity_calendar_stripe:last")}function y(){var t=b(B.date);B.date=t;var a=G.find(".ogx_mobile_activity_calendar_day:last").detach(),i=b(B.date);a.children(".ogx_mobile_activity_calendar_nav:first").text(i.toString().substr(0,15)),a.find(".ogx_mobile_activity_calendar_content:first").empty(),G.prepend(a);var e=u(i);e&&x(e,i.getDay(),G.find(".ogx_mobile_activity_calendar_day:first"));var n=_(G);G.css({transform:"translate3D("+(Number(n[0])-B.width)+"px, 0px, 0px)"})}function h(){var t=m(B.date);B.date=t;var a=G.find(".ogx_mobile_activity_calendar_day:first").detach(),i=m(B.date);a.children(".ogx_mobile_activity_calendar_nav:first").text(i.toString().substr(0,15)),a.find(".ogx_mobile_activity_calendar_content:first").empty(),G.append(a);var e=u(i);e&&x(e,i.getDay(),G.find(".ogx_mobile_activity_calendar_day:last"));var n=_(G);G.css({transform:"translate3D("+(Math.abs(n[0])-B.width)*-1+"px, 0px, 0px)"})}function m(t){var a=new Date(t.toString());return new Date(a.getFullYear(),a.getMonth(),a.getDate()+1)}function b(t){var a=new Date(t.toString());return new Date(a.getFullYear(),a.getMonth(),a.getDate()-1)}function u(t){var a,i;for(var e in B.data.calendar)if(a=e.split("_"),a[0]=new Date(a[0]).getTime(),a[1]=new Date(a[1]).getTime(),i=t.getTime(),i>=a[0]&&i<=a[1])return B.data.calendar[e];return!1}function p(){var t=B.date.getDay(),a=u(B.date);if(a){var i;t-=2,t<0?t=6-(t-2):null;for(var e=0;e<3;e++)i=A.children(".ogx_mobile_activity_calendar_days:first").children(".ogx_mobile_activity_calendar_day:eq("+e+")"),x(a,t+e,i)}P.el.trigger(OGX.MobileActivityCalendar.RENDER)}function x(t,a,i){var e,n,o,r,c;for(var l in t[a])for(var d=0;d<t[a][l].length;d++)o=t[a][l][d],e=s(l,o),r=g(i,e),c=B.data.categories[o.type].color,n='<div class="ogx_mobile_activity_calendar_block" style="top:'+e.y+"px; height:"+e.h+"px; background-color:"+c+';" data-start="'+l+'" data-length="'+o.length+'" data-type="'+o.type+'"><span>'+o.label+"</span></div>",r.append(n);var _=i.find(".ogx_mobile_activity_calendar_content:first").children(".ogx_mobile_activity_calendar_stripe").length,v=Math.floor(B.width/_);i.find(".ogx_mobile_activity_calendar_content:first").children(".ogx_mobile_activity_calendar_stripe").each(function(t,a){$(a).css("width",v+"px")})}function w(){switch(B.mode){case OGX.MobileActivityCalendar.MODE_MOBILE:k="touchstart",N="touchend",S="touchmove";break;case OGX.MobileActivityCalendar.MODE_DESKTOP:k="mousedown",N="mouseup",S="mousemove"}}function M(){for(var t=0;t<3;t++)O(t)}function D(t,a){switch(a){case 1:t<=12?t+="<span>am</span>":t=t-12+"<span>pm</span>";break;case 2:t<10?t="0"+t:null}return t}function O(t){for(var a,i,e=A.height()-G.find(".ogx_mobile_activity_calendar_nav:first").height(),n=B.day_end-B.day_start+1,o=Math.floor(e/n),r="",c=G.children(".ogx_mobile_activity_calendar_day:eq("+t+")").children(".ogx_mobile_activity_calendar_grid:first"),l=0;l<n;l++)a=B.day_start+l,i=B.ampm?D(a,1):D(a,2),r+='<div class="ogx_mobile_activity_calendar_hour" data-hour="'+a+'" style="height:'+o+'px;"><span class="ogx_mobile_activity_calendar_hour_label">'+i+"</span></div>";c.html(r),T=c.find(".ogx_mobile_activity_calendar_hour:first").height()}function C(){for(var t=A.width(),a=0,i=[b(B.date),B.date,m(B.date)],e='<div class="ogx_mobile_activity_calendar_days" style="width:'+3*t+'px;">',n=0;n<3;n++)e+='<div class="ogx_mobile_activity_calendar_day" style="width:'+t+'px;">',e+='<div class="ogx_mobile_activity_calendar_nav">'+i[n].toString().substr(0,15)+"</div>",e+='<div class="ogx_mobile_activity_calendar_grid"></div>',e+='<div class="ogx_mobile_activity_calendar_content"></div>',e+="</div>",a+=t;e+="</div>",A.append(e),G=A.find(".ogx_mobile_activity_calendar_days:first"),G.css({transform:"translate3D("+-B.width+"px, 0, 0)"})}function E(){for(var t in H)B.hasOwnProperty(t)||(B[t]=H[t]);B.width=$(B.container).innerWidth(),B.height=$(B.container).innerHeight(),P.el=A=$(B.container),A.addClass("ogx_mobile_activity_calendar ogx_hw")}function X(){E(),w(),C(),M(),B.data&&setTimeout(p,100),e(!0),o(!0),i(!0)}var A,G,T,k,N,S,Y,I,L,R,q,P=this,B=t,H={day_start:6,day_end:21,date:new Date,ampm:!0,data:!1,mode:OGX.MobileActivityCalendar.MODE_MOBILE,minX:60,maxY:5,maxT:100},z={},F=!1;this.el=null,this.setData=function(t){B.data=t,p()},this.destroy=function(){e(!1),n(!1),r(!1),d(!1),i(!1)},X()},OGX.MobileActivityCalendar=function(t){"use strict";return new OGX.prototype.MobileActivityCalendar(t)},OGX.MobileActivityCalendar.MODE_DESKTOP="desktop",OGX.MobileActivityCalendar.MODE_MOBILE="mobile",OGX.MobileActivityCalendar.SELECT="MobileActivityCalendarSelect",OGX.MobileActivityCalendar.DAY_CHANGE="MobileActivityCalendarDayChange",OGX.MobileActivityCalendar.RENDER="MobileActivityCalendarRender";