if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.MobileChatBox=function(e){"use strict";function o(){if(y.html('<div class="ogx_mobile_chat_box_spacer" style="height:'+M.outerHeight(!0)+'px;"></div>'),E.messages.length>0){for(var e=0;e<E.messages.length;e++)t(E.messages[e]);O.update(),O.bottom()}}function t(e){var o=r(e),t=_(e,o);y.find(".ogx_mobile_chat_box_spacer:first").before(t);var a=y.children(".ogx_mobile_chat_box_message:last");setTimeout(function(){a.addClass("ogx_mobile_chat_box_message_anim"),O.update(),O.bottom()},100)}function a(e){G[e]=!0;var o='<div class="ogx_mobile_chat_box_typing" data-user="'+e+'"><span class="ogx_mobile_chat_box_typing_body">.</div></div>';y.append(o),n(!0)}function s(e){G[e]=!1,y.find('.ogx_mobile_chat_box_typing[data-user="'+e+'"]').remove(),0===y.find(".ogx_mobile_chat_box_typing").length&&n(!1)}function n(e){e?w||(w=setInterval(i,E.dot_speed)):(clearInterval(w),w=null)}function i(){S+=".",S.length>3?S=".":null,y.find(".ogx_mobile_chat_box_typing_body").html(S)}function r(e){return e.from.toString()===E.users.current?E.template_right:E.template_left}function _(e,o){var t=o;for(var a in e)reg=new RegExp("\\$"+a,"g"),t=t.replace(reg,e[a]);return reg=new RegExp("\\$user","g"),t=t.replace(reg,e.from),reg=new RegExp("\\$letter","g"),t=t.replace(reg,E.users[e.from].name.substr(0,1).toUpperCase())}function l(){var e=M.find("textarea:first").val(),o=new Date;if(e.length>0){e=e.replace(/[\r\n]/g,"<br>");var a={from:E.users.current,to:E.users.remote,message:e,date:o.toISOString().split("T").shift()};t(a),M.find("textarea:first").val(""),C.el.trigger(OGX.MobileChatBox.SEND_MSG,a)}}function c(e){var o=-M.height()-e.keyboardHeight;M.css({transform:"translate3D(0px, "+o+"px, 0px)"}),y.find(".ogx_mobile_chat_box_spacer:first").height(e.keyboardHeight)}function g(){M.css({transform:"translate3D(0px, "+-M.height()+"px, 0px)"}),y.find(".ogx_mobile_chat_box_spacer:first").height(M.outerHeight(!0))}function h(e){e?(window.addEventListener("native.keyboardshow",c),window.addEventListener("native.keyboardhide",g)):(window.removeEventListener("native.keyboardshow",c),window.removeEventListener("native.keyboardhide",g))}function d(e){e?M.on("keyup","textarea",function(e){13===e.which&&(l(),E.hide_keyboard_on_send&&g())}):M.off("keyup","textarea")}function b(e){e?M.on("click",".ogx_mobile_chat_box_composer_send",function(){l(),E.hide_keyboard_on_send&&g()}):M.off("click",".ogx_mobile_chat_box_composer_send")}function p(){var e=v.height(),o=v.width(),t='<div class="ogx_mobile_chat_box_composer" style="top:'+e+"px; width:"+o+'px;"><span class="ogx_mobile_chat_box_composer_input"><textarea placeholder="'+E.placeholder+'">';t+='</textarea></span><span class="ogx_mobile_chat_box_composer_send"></span></div>',v.prepend(t),M=v.find(".ogx_mobile_chat_box_composer:first"),e=M.outerHeight(!0),M.css("transform","translate3D(0px, "+-e+"px, 0px)")}function x(){O=new OGX.MobileScrollContainer({container:C.el[0],initDelay:100,autoScroll:!0}),C.el.on(OGX.MobileScrollContainer.READY,function(){C.el.off(OGX.MobileScrollContainer.READY),y=O.getInner(),y=$(y),y.addClass("ogx_mobile_chat_box"),y.height(y.height()-M.outerHeight(!0)),O.update(),o()})}function m(){for(var e in E.users)G[e]=!1}function f(){for(var e in k)E.hasOwnProperty(e)||(E[e]=k[e]);C.el=v=$(E.container)}function u(){return"undefined"==typeof OGX.MobileScrollContainer?void console.log("%c CRITICAL ERROR - OGX.MobileScrollContainer not found! ","background:#222; color: #FF0000"):(f(),p(),m(),x(),E.handle_keyboard&&h(!0),b(!0),void d(!0))}var v,y,O,M,w,C=this,E=e,k={placeholder:"Type a message",dot_speed:600,messages:[],handle_keyboard:!0,hide_keyboard_on_send:!1,mode:OGX.MobileChatBox.MODE_DESKTOP,template_left:'<div class="ogx_mobile_chat_box_message ogx_mobile_chat_box_message_left" data-user="$user"><span class="ogx_mobile_chat_box_message_icon"><span>$letter</span></span><span class="ogx_mobile_chat_box_message_container"><span class="ogx_mobile_chat_box_message_body">$message</span><span class="ogx_mobile_chat_box_message_date">$date</span><span style="clear:both"></span></span></div>',template_right:'<div class="ogx_mobile_chat_box_message ogx_mobile_chat_box_message_right" data-user="$user"><span class="ogx_mobile_chat_box_message_container"><span class="ogx_mobile_chat_box_message_body">$message</span><span class="ogx_mobile_chat_box_message_date">$date</span><span style="clear:both"></span></span></div>'},G={},S=".";this.el=null,this.setUsers=function(e){E.users=e},this.setRemote=function(e){E.remote=e},this.addMessage=function(e){t(e)},this.setMessages=function(e){E.messages=e,o()},this.userTyping=function(e,o){e&&!G[o]?a(o):!e&&G[o]&&s(o)},this.setCompose=function(e){M.find("textarea:first").val(e)},this.clear=function(){y.empty()},this.destroy=function(){h(!1),d(!1),b(!1)},u()},OGX.MobileChatBox=function(e){"use strict";return new OGX.prototype.MobileChatBox(e)},OGX.MobileChatBox.MODE_DESKTOP="desktop",OGX.MobileChatBox.MODE_MOBILE="mobile",OGX.MobileChatBox.SEND_MSG="MobileChatBoxSend";