if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.MobileChatBox=function(e){"use strict";function o(){v.empty();for(var e=0;e<w.messages.length;e++)t(w.messages[e])}function t(e){var o=r(e),t=l(e,o);v.append(t),setTimeout(function(){v.children('.ogx_mobile_chat_box_message[data-user="'+e.user+'"]').addClass("ogx_mobile_chat_box_message_anim")},100)}function n(e){E[e]=!0;var o='<div class="ogx_mobile_chat_box_typing" data-user="'+e+'"><span class="ogx_mobile_chat_box_typing_body">.</div></div>';v.append(o),i(!0)}function a(e){E[e]=!1,v.find('.ogx_mobile_chat_box_typing[data-user="'+e+'"]').remove(),0===v.find(".ogx_mobile_chat_box_typing").length&&i(!1)}function i(e){e?M||(M=setInterval(s,w.dot_speed)):(clearInterval(M),M=null)}function s(){S+=".",S.length>3?S=".":null,v.find(".ogx_mobile_chat_box_typing_body").html(S)}function r(e){return e.user.toString()===w.users.current?w.template_right:w.template_left}function l(e,o){var t=o;for(var n in e)reg=new RegExp("\\$"+n,"g"),t=t.replace(reg,e[n]);return t}function _(){var e=O.find("textarea:first").val(),o=new Date;if(e.length>0){var n={from:"appraiser",msg:e,date:o.toISOString().split("T").shift()};t(n),O.find("textarea:first").val(""),C.el.trigger(OGX.MobileChatBox.SEND_MSG,n)}}function c(e){console.log(e.keyboardHeight);var o=-O.height()-e.keyboardHeight;O.css({transform:"translate3D(0px, "+o+"px, 0px)"})}function d(){O.css({transform:"translate3D(0px, "+-O.height()+"px, 0px)"}),_()}function g(e){e?(window.addEventListener("native.keyboardshow",c),window.addEventListener("native.keyboardhide",d)):(window.removeEventListener("native.keyboardshow",c),window.removeEventListener("native.keyboardhide",d))}function b(e){e?O.on("click",".ogx_mobile_chat_box_composer_send",function(){d()}):O.off("click",".ogx_mobile_chat_box_composer_send")}function p(){var e=$(window).height(),o='<div class="ogx_mobile_chat_box_composer" style="top:'+e+'px;"><span class="ogx_mobile_chat_box_composer_input"><textarea placeholder="'+w.placeholder+'">';o+='</textarea></span><span class="ogx_mobile_chat_box_composer_send"></span></div>',u.prepend(o),O=u.find(".ogx_mobile_chat_box_composer:first"),e=O.height(),O.css("transform","translate3D(0px, "+-e+"px, 0px)")}function x(){y=new OGX.MobileScrollContainer({container:C.el[0],initDelay:100,autoScroll:!0}),C.el.on(OGX.MobileScrollContainer.READY,function(){C.el.off(OGX.MobileScrollContainer.READY),v=y.getInner(),v=$(v),v.addClass("ogx_mobile_chat_box"),o()})}function h(){for(var e in w.users)E[e]=!1}function m(){for(var e in G)w.hasOwnProperty(e)||(w[e]=G[e]);C.el=u=$(w.container)}function f(){return"undefined"==typeof OGX.MobileScrollContainer?void console.log("%c CRITICAL ERROR - OGX.MobileScrollContainer not found! ","background:#222; color: #FF0000"):(m(),p(),h(),x(),g(!0),void b(!0))}var u,v,y,O,M,C=this,w=e,G={placeholder:"Type a message",dot_speed:600,messages:[],mode:OGX.MobileChatBox.MODE_DESKTOP,template_left:'<div class="ogx_mobile_chat_box_message ogx_mobile_chat_box_message_left" data-user="$user"><span class="ogx_mobile_chat_box_message_icon"><span>M</span></span><span class="ogx_mobile_chat_box_message_body">$msg</span></div>',template_right:'<div class="ogx_mobile_chat_box_message ogx_mobile_chat_box_message_right" data-user="$user"><span class="ogx_mobile_chat_box_message_body">$msg</span></div>'},E={},S=".";this.el=null,this.addMessage=function(e){t(e)},this.userTyping=function(e,o){e&&!E[o]?n(o):!e&&E[o]&&a(o)},f()},OGX.MobileChatBox=function(e){"use strict";return new OGX.prototype.MobileChatBox(e)},OGX.MobileChatBox.MODE_DESKTOP="desktop",OGX.MobileChatBox.MODE_MOBILE="mobile",OGX.MobileChatBox.SEND_MSG="MobileChatBoxSend";