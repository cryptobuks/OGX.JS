if(typeof OGX==="undefined"){var OGX=function(){}}OGX.prototype.Grid=function(t){"use strict";var r=this;var a={max_rows:10,force_type:true,editable:false};var i=t;var n=null;var e=null;var d=null;var o=null;var f=0;this.el=null;this.getSelectedRow=function(){return e};this.setData=function(t){if(t){i.data=t;b();u();l()}};this.getData=function(){if(i.hasOwnProperty("data")){return i.data}return[]};this.setPage=function(t){f=t;c(i.data)};this.getTotalPages=function(){return Math.ceil(i.data.length/i.max_rows)};this.sort=function(t,r){var a=h(t,r);c(a)};this.updateSelectedObject=function(t,r){if(e){e[t]=r;s(e)}};function s(t){var r=1;var a;for(var n in i.columns){a=t[n];$(".ogx_grid_selected_row:first").find("td:nth-child("+r+")").text(a);r++}}function l(){$(i.container).append('<div class="ogx_grid_head"><table width="100%" border="1px"><tr></tr></table></div>');$(i.container).append('<div class="ogx_grid_body"><table width="100%" border="1px"><tr></tr></table></div>');for(var t in i.data[0]){$(i.container).find(".ogx_grid_head:first table").find("tr:first").append('<td width="'+i.columns[t]+'%" class="ogx_grid_column_head" data-way="1"><span>'+t+'</span><span class="ogx_grid_head_arrow"></span></td>')}c(i.data)}function c(){$(i.container).find(".ogx_grid_body:first").html('<table width="100%" border="1px"><tr></tr></table>');var t=0;if(i.max_rows>i.data.length||i.max_rows===0){t=i.data.length}else{t=i.max_rows}var r=f*i.max_rows;r<i.data.length?r=r:r=i.data.length-1;for(var a=r;a<r+t;a++){$(i.container).find(".ogx_grid_body:first table").append('<tr class="ogx_grid_row"></tr>');var n;for(var d in i.data[a]){n=false;if(e){if(x(e,i.data[a])){n=true}}$(i.container).find(".ogx_grid_body:first table").find("tr:last").append('<td width="'+i.columns[d]+'%">'+i.data[a][d]+"</td>");if(n){$(i.container).find(".ogx_grid_body:first table").find("tr:last").addClass("ogx_grid_selected_row")}}}}function u(){$(i.container).find(".ogx_grid_head").remove();$(i.container).find(".ogx_grid_body").remove()}function g(t){$(".ogx_grid_head_arrow").text("");r.sortTable($(t).text(),Number($(t).data("way")));var a="˄";var i=Number($(t).data("way"))*-1;i===-1?a="˄":a="˅";$(t).find(".ogx_grid_head_arrow:first").text(a);$(t).data("way",i)}function _(t,r){return function(a,i){return a[t]<i[t]?r*-1:a[t]>i[t]?r:0}}function h(t,r){var a=i.data;a.sort(_(t,r));return a}function v(t){var r={};var a;var n;$(t).find("td").each(function(t,e){a=$(i.container).find(".ogx_grid_head:first table").find("tr").find("td:nth-child("+(t+1)+")").find("span:first").text();n=$(e).text();if(i.force_type){if(!isNaN(Number(n))&&n!==""){n=Number(n)}else{if(n==="true"){n=true}else{if(n==="false"){n=false}}}}r[a]=n});for(var e=0;e<i.data.length;e++){console.log("compare",i.data[e],r);if(x(i.data[e],r)){console.log("found",i.data[e]);return i.data[e]}}console.log("didnt find");return false}function x(t,r){if(i.hasOwnProperty("key")){if(t[i.key]===r[i.key]){return true}return false}else{if(JSON.stringify(r)===JSON.stringify(t)){return true}return false}}function p(t,r){var a;var n;var e;if(t){o=r;var f=v(r);if(f){d=f;$(r).find("td").each(function(t,r){a=$(r).text();e=$(r).width();$(r).html('<input type="text" value="'+a+'" style="width:'+(e-4)+'px">')})}}else{if(o&&d){$(o).find("td").each(function(t,r){a=$(r).find("input:first").val();$(i.container).find(".ogx_grid_head:first").find("td").each(function(i,e){if(i===t){n=$(e).find("span:first").text();d[n]=a;$(r).html(a)}})});o=null;d=null}console.log(i.data)}}function w(){$(i.container).on("click",".ogx_grid_column_head",function(){g(this)});$(i.container).on("click",".ogx_grid_row",function(){if(i.editable&&o&&$(o)[0]!==$(this)[0]){p(false);return}$(".ogx_grid_selected_row").removeClass("ogx_grid_selected_row");if(n===this){$(i.container).trigger(OGX.Grid.UNSELECT,e);e=null;n=null;return}var t=v(this);$(i.container).trigger(OGX.Grid.SELECT,t);n=this;e=t;$(this).addClass("ogx_grid_selected_row")});if(i.editable){$(i.container).on("dblclick",".ogx_grid_row",function(){if(this!==o){if(o){p(false,o)}p(true,$(this))}})}}function b(){if(!i.hasOwnProperty("columns")){if(i.hasOwnProperty("data")){i.columns={};var t=0;for(var r in i.data[0]){t++}var a=Math.round(100/t);for(r in i.data[0]){i.columns[r]=a}}else{}}}function y(){if(!i){i={}}for(var t in a){if(!i[t]){i[t]=a[t]}}r.el=$(i.container)}function m(){y();if(i.hasOwnProperty("data")){b();l()}w()}m()};OGX.Grid=function(t){"use strict";return new OGX.prototype.Grid(t)};OGX.Grid.SELECT="select";OGX.Grid.UNSELECT="unselect";